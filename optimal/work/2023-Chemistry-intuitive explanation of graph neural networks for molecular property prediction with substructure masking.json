{
    "paper_id": "work\\2023-Chemistry-intuitive explanation of graph neural networks for molecular property prediction with substructure masking",
    "header": {
        "generated_with": "S2ORC 1.0.0",
        "date_generated": "2024-12-06T16:55:16.162606Z"
    },
    "title": "Chemistry-intuitive explanation of graph neural networks for molecular property prediction with substructure masking",
    "authors": [
        {
            "first": "Zhenxing",
            "middle": [],
            "last": "Wu",
            "suffix": "",
            "affiliation": {
                "laboratory": "",
                "institution": "Zhejiang University",
                "location": {
                    "postCode": "310058",
                    "settlement": "Hangzhou Zhejiang",
                    "country": "P.R. China"
                }
            },
            "email": ""
        },
        {
            "first": "Jike",
            "middle": [],
            "last": "Wang",
            "suffix": "",
            "affiliation": {
                "laboratory": "",
                "institution": "Zhejiang University",
                "location": {
                    "postCode": "310058",
                    "settlement": "Hangzhou Zhejiang",
                    "country": "P.R. China"
                }
            },
            "email": ""
        },
        {
            "first": "Hongyan",
            "middle": [],
            "last": "Du",
            "suffix": "",
            "affiliation": {
                "laboratory": "",
                "institution": "Zhejiang University",
                "location": {
                    "postCode": "310058",
                    "settlement": "Hangzhou Zhejiang",
                    "country": "P.R. China"
                }
            },
            "email": ""
        },
        {
            "first": "Dejun",
            "middle": [],
            "last": "Jiang",
            "suffix": "",
            "affiliation": {
                "laboratory": "",
                "institution": "Zhejiang University",
                "location": {
                    "postCode": "310058",
                    "settlement": "Hangzhou Zhejiang",
                    "country": "P.R. China"
                }
            },
            "email": ""
        },
        {
            "first": "Yu",
            "middle": [],
            "last": "Kang",
            "suffix": "",
            "affiliation": {
                "laboratory": "",
                "institution": "Zhejiang University",
                "location": {
                    "postCode": "310058",
                    "settlement": "Hangzhou Zhejiang",
                    "country": "P.R. China"
                }
            },
            "email": ""
        },
        {
            "first": "Dan",
            "middle": [],
            "last": "Li",
            "suffix": "",
            "affiliation": {
                "laboratory": "",
                "institution": "Zhejiang University",
                "location": {
                    "postCode": "310058",
                    "settlement": "Hangzhou Zhejiang",
                    "country": "P.R. China"
                }
            },
            "email": ""
        },
        {
            "first": "Peichen",
            "middle": [],
            "last": "Pan",
            "suffix": "",
            "affiliation": {
                "laboratory": "",
                "institution": "Zhejiang University",
                "location": {
                    "postCode": "310058",
                    "settlement": "Hangzhou Zhejiang",
                    "country": "P.R. China"
                }
            },
            "email": ""
        },
        {
            "first": "Yafeng",
            "middle": [],
            "last": "Deng",
            "suffix": "",
            "affiliation": {
                "laboratory": "",
                "institution": "CarbonSilicon AI Technology Co., Ltd",
                "location": {
                    "postCode": "310018",
                    "settlement": "Hangzhou Zhejiang",
                    "country": "P.R. China"
                }
            },
            "email": ""
        },
        {
            "first": "Dongsheng",
            "middle": [],
            "last": "Cao",
            "suffix": "",
            "affiliation": {
                "laboratory": "",
                "institution": "Central South University",
                "location": {
                    "postCode": "410004",
                    "settlement": "Changsha Hunan",
                    "country": "P.R. China"
                }
            },
            "email": ""
        },
        {
            "first": "Chang-Yu",
            "middle": [],
            "last": "Hsieh",
            "suffix": "",
            "affiliation": {
                "laboratory": "",
                "institution": "Zhejiang University",
                "location": {
                    "postCode": "310058",
                    "settlement": "Hangzhou Zhejiang",
                    "country": "P.R. China"
                }
            },
            "email": ""
        },
        {
            "first": "Tingjun",
            "middle": [],
            "last": "Hou",
            "suffix": "",
            "affiliation": {
                "laboratory": "",
                "institution": "Zhejiang University",
                "location": {
                    "postCode": "310058",
                    "settlement": "Hangzhou Zhejiang",
                    "country": "P.R. China"
                }
            },
            "email": "tingjunhou@zju.edu.cn"
        }
    ],
    "year": "",
    "venue": null,
    "identifiers": {},
    "abstract": "Graph neural networks (GNNs) have been widely used in molecular property prediction, but explaining their black-box predictions is still a challenge. Most existing explanation methods for GNNs in chemistry focus on attributing model predictions to individual nodes, edges or fragments that are not necessarily derived from a chemically meaningful segmentation of molecules. To address this challenge, we propose a method named substructure mask explanation (SME). SME is based on well-established molecular segmentation methods and provides an interpretation that aligns with the understanding of chemists. We apply SME to elucidate how GNNs learn to predict aqueous solubility, genotoxicity, cardiotoxicity and blood-brain barrier permeation for small molecules. SME provides interpretation that is consistent with the understanding of chemists, alerts them to unreliable performance, and guides them in structural optimization for target properties. Hence, we believe that SME empowers chemists to confidently mine structure-activity relationship (SAR) from reliable GNNs through a transparent inspection on how GNNs pick up useful signals when learning from data.\nIn the past decades, deep learning (DL) has gained tractions and has been successfully applied to predict a broad range of molecular properties due to its strong capability to model complex nonlinear relationships between structures and properties 1-5 . However, this superior capability to capture intricate nonlinear relationships is originally achieved at the expense of model interpretability, leading to black-box predictions without insights [6] [7] [8] . For scientific investigations, such as drug discovery, what we want to know is not only the predictions of a model but also an explanation to validate scientific hypothesis and gain actionable insights to refine our investigations, such as hints for molecular structural optimization 7 .\nIdeally, an insightful interpretation should uncover potentially generalizable principles or actionable insights behind the structure-activity or structure-property relationships, thereby allowing scientists to gauge the reliability of model predictions. In fact, some researchers in medicinal chemistry might value the interpretability of a model over its accuracy [8] [9] [10] [11] if a small sacrifice of accuracy can enhance its interpretability. Motivated by the reasons above, many explainable artificial intelligence (XAI) methods have been proposed to address the general lack of interpretability in molecular GNNs in order to augment human reasoning and decision-making 7, 8, 12, 13 .\nHowever, most existing methods directly adopt attribution methods for XAI developed in other fields. Different from other unrelated applications, such as natural language processing and image recognition, in which DL has been shown to excel, there is no naturally applicable, complete, and 'raw' molecular representation. After all,",
    "pdf_parse": {
        "paper_id": "work\\2023-Chemistry-intuitive explanation of graph neural networks for molecular property prediction with substructure masking",
        "_pdf_hash": "",
        "abstract": [
            {
                "text": "Graph neural networks (GNNs) have been widely used in molecular property prediction, but explaining their black-box predictions is still a challenge. Most existing explanation methods for GNNs in chemistry focus on attributing model predictions to individual nodes, edges or fragments that are not necessarily derived from a chemically meaningful segmentation of molecules. To address this challenge, we propose a method named substructure mask explanation (SME). SME is based on well-established molecular segmentation methods and provides an interpretation that aligns with the understanding of chemists. We apply SME to elucidate how GNNs learn to predict aqueous solubility, genotoxicity, cardiotoxicity and blood-brain barrier permeation for small molecules. SME provides interpretation that is consistent with the understanding of chemists, alerts them to unreliable performance, and guides them in structural optimization for target properties. Hence, we believe that SME empowers chemists to confidently mine structure-activity relationship (SAR) from reliable GNNs through a transparent inspection on how GNNs pick up useful signals when learning from data.",
                "cite_spans": [],
                "ref_spans": [],
                "eq_spans": [],
                "section": "Abstract",
                "sec_num": null
            },
            {
                "text": "In the past decades, deep learning (DL) has gained tractions and has been successfully applied to predict a broad range of molecular properties due to its strong capability to model complex nonlinear relationships between structures and properties 1-5 . However, this superior capability to capture intricate nonlinear relationships is originally achieved at the expense of model interpretability, leading to black-box predictions without insights [6] [7] [8] . For scientific investigations, such as drug discovery, what we want to know is not only the predictions of a model but also an explanation to validate scientific hypothesis and gain actionable insights to refine our investigations, such as hints for molecular structural optimization 7 .",
                "cite_spans": [
                    {
                        "start": 448,
                        "end": 451,
                        "text": "[6]",
                        "ref_id": "BIBREF5"
                    },
                    {
                        "start": 452,
                        "end": 455,
                        "text": "[7]",
                        "ref_id": "BIBREF6"
                    },
                    {
                        "start": 456,
                        "end": 459,
                        "text": "[8]",
                        "ref_id": "BIBREF7"
                    }
                ],
                "ref_spans": [],
                "eq_spans": [],
                "section": "Abstract",
                "sec_num": null
            },
            {
                "text": "Ideally, an insightful interpretation should uncover potentially generalizable principles or actionable insights behind the structure-activity or structure-property relationships, thereby allowing scientists to gauge the reliability of model predictions. In fact, some researchers in medicinal chemistry might value the interpretability of a model over its accuracy [8] [9] [10] [11] if a small sacrifice of accuracy can enhance its interpretability. Motivated by the reasons above, many explainable artificial intelligence (XAI) methods have been proposed to address the general lack of interpretability in molecular GNNs in order to augment human reasoning and decision-making 7, 8, 12, 13 .",
                "cite_spans": [
                    {
                        "start": 366,
                        "end": 369,
                        "text": "[8]",
                        "ref_id": "BIBREF7"
                    },
                    {
                        "start": 370,
                        "end": 373,
                        "text": "[9]",
                        "ref_id": "BIBREF8"
                    },
                    {
                        "start": 374,
                        "end": 378,
                        "text": "[10]",
                        "ref_id": "BIBREF9"
                    },
                    {
                        "start": 379,
                        "end": 383,
                        "text": "[11]",
                        "ref_id": "BIBREF10"
                    },
                    {
                        "start": 679,
                        "end": 681,
                        "text": "7,",
                        "ref_id": "BIBREF6"
                    },
                    {
                        "start": 682,
                        "end": 684,
                        "text": "8,",
                        "ref_id": "BIBREF7"
                    },
                    {
                        "start": 685,
                        "end": 688,
                        "text": "12,",
                        "ref_id": "BIBREF11"
                    }
                ],
                "ref_spans": [],
                "eq_spans": [],
                "section": "Abstract",
                "sec_num": null
            },
            {
                "text": "However, most existing methods directly adopt attribution methods for XAI developed in other fields. Different from other unrelated applications, such as natural language processing and image recognition, in which DL has been shown to excel, there is no naturally applicable, complete, and 'raw' molecular representation. After all,",
                "cite_spans": [],
                "ref_spans": [],
                "eq_spans": [],
                "section": "Abstract",
                "sec_num": null
            }
        ],
        "body_text": [
            {
                "text": "molecules themselves are models that scientists conceive 8 . The choice of molecular representation could be a limiting factor for model explanation and performance because it inherently determines the kind of chemical information readily available for model training and prediction. A common choice is molecular graphs, which intuitively correspond to chemical structures (nodes to atoms, edges to chemical bonds, and subgraphs to substructures such as functional groups). This observation indicates molecular graphs as a suitable representation with great potential for chemist-friendly interpretability. Recently, several approaches have been proposed to analyze and interpret how GNNs make predictions [14] [15] [16] [17] [18] [19] . However, most methods essentially attribute GNNs' predictions to individual nodes, edges, or node features. This kind of interpretability is only partially compatible with chemists' intuition at best. Chemists are more accustomed to comprehending the causal relationship between molecular structures and properties in terms of chemically meaningful substructures, such as functional groups, rather than individual atoms or bonds.",
                "cite_spans": [
                    {
                        "start": 706,
                        "end": 710,
                        "text": "[14]",
                        "ref_id": "BIBREF13"
                    },
                    {
                        "start": 711,
                        "end": 715,
                        "text": "[15]",
                        "ref_id": "BIBREF14"
                    },
                    {
                        "start": 716,
                        "end": 720,
                        "text": "[16]",
                        "ref_id": "BIBREF15"
                    },
                    {
                        "start": 721,
                        "end": 725,
                        "text": "[17]",
                        "ref_id": "BIBREF16"
                    },
                    {
                        "start": 726,
                        "end": 730,
                        "text": "[18]",
                        "ref_id": "BIBREF17"
                    },
                    {
                        "start": 731,
                        "end": 735,
                        "text": "[19]",
                        "ref_id": "BIBREF18"
                    }
                ],
                "ref_spans": [],
                "eq_spans": [],
                "section": "",
                "sec_num": null
            },
            {
                "text": "Following the survey work reported by Yuan et al. 19 , existing explanation methods can be categorized into 5 classes: gradients/ features-based methods, decomposition methods, surrogate methods, generation-based methods, and perturbation-based methods. Gradients/features-based methods employ gradient values or feature values to assess the importance of input graph nodes, edges or node features by extending existing image explanation techniques to the graph domain, such as sensitivity analysis (SA) 18 , guided backpropagation (GBP) 18 and class activation mapping (CAM) 20 . Decomposition methods decompose the original model predictions into several terms following the backpropagation and take these terms as the importance scores of the corresponding input features (graph nodes or edges) to explain GNN models, and the representative works in this category include layer-wise relevance propagation (LRP) 18, 21 , excitation backpropagation (Excitation BP) 20 and GNN-LRP 22 . The above two types of methods use gradients and closely-related backpropagation to explain models, so they can only be used to explain a single GNN model and cannot be applied to study ensemble methods. Since many high-performing property prediction models are integrated from multiple sub-models, we have to rely on alternative methods to derive explanations. For instance, surrogate methods do not suffer from the above constraints. They employ simple and interpretable models such as linear models based on interpretable descriptors to capture local relationships of deep graph models around the input data, and the representative works include GraphLime 23 and PGM-Explainer 17 . The explanations of the prediction of a surrogate model are taken as the explanation for the original model. However, the surrogate methods usually do not work with molecular graphs and are not fully compatible with expert knowledge based on reasoning with molecular graphs. XGNN is the only generation-based method that renders high-level explanations of GNNs by generating graph patterns that support the given prediction 24 of an underlying GNN model. As the only global GNN interpretation method, it has made a good attempt, but the explainable graph patterns it generates are often meaningless chemical fragments and the explanation related to mutagenicity is not intuitive. There are also perturbation-based methods that identify key features by monitoring the degrees of changes in the predictions through perturbing different input features, such as GNNExplainer 15 , PGExplainer 16 and SubgraphX 19 . GNNExplainer and PGExplainer provide subgraph-level explanations by combining nodes or edges to form subgraphs through post-processing, but the important nodes or edges highlighted by these methods are not guaranteed to be connected as one fragment. Sub-graphX can identify connected subgraphs with Monte Carlo tree search. However, due to the complexity of chemistry rules, the fragments uncovered by these perturbative methods are often not chemically meaningful and prone to generating confusing or even frustrating interpretations for chemists. For example, SubgraphX splits a common functional group such as nitro into oxygen atoms and nitrogen atoms for separate masking, but a nitro group should be treated as a whole when deducing structure-property relationships. Moreover, similar to gradient-based methods, SubgraphX cannot be directly used to study a consensus model integrated by multiple submodels, since it identifies subgraphs through Monte Carlo tree search and different subgraphs may be identified in different sub-models. Given a trained consensus GNN model and an input graph, different sub-models will identify different important subgraphs, so it is difficult to give a consistent and unified important subgraph for a consensus model. As summarized above, all existing methods could potentially be improved to better suit the needs of the chemistry community, and a more detailed account on all these methods can be found in reference 14 .",
                "cite_spans": [
                    {
                        "start": 914,
                        "end": 917,
                        "text": "18,",
                        "ref_id": "BIBREF17"
                    }
                ],
                "ref_spans": [],
                "eq_spans": [],
                "section": "",
                "sec_num": null
            },
            {
                "text": "In short, chemists prefer to investigate molecular properties and reactivity in terms of chemically meaningful fragments rather than individual atoms or bonds without a proper characterization of the atomic environment. For example, when medicinal chemists try to optimize the structure of a lead compound, they often consider the replacement of bioisosteres and functional groups. A toxophore commonly used for toxicity structural alerts is also defined in terms of a chemical group that is responsible for toxic effects rather than a simple atom or bond without context. Similar reasoning can be applied to appreciate the benefits of introducing the concept of pharmacophore in drug design. All in all, it is more natural to explore the molecular properties in terms of fragments/subgraphs rather than atoms/bonds without a proper context. However, no method has been developed to explain the predictions from GNNs by attributing predictions to fragments derived from chemical knowledge. For instance, one can segment a molecule by breaking chemical bonds to generate retrosynthetically feasible chemical substructures (BRICS) 25 .",
                "cite_spans": [],
                "ref_spans": [],
                "eq_spans": [],
                "section": "",
                "sec_num": null
            },
            {
                "text": "In this work, motivated by the lack of a proper XAI technique for analyzing molecular GNNs strictly in terms of chemically meaningful fragments, we propose a perturbation-based explanation method named Substructure-Mask Explanation (SME) that effectively identifies the most crucial set of substructures in a molecule that are responsible for a model's prediction. Three different methods for molecular fragmentation (i.e., BRICS substructures 25 , Murcko substructures 26, 27 , and functional groups) are incorporated into SME in order to give chemists a high flexibility by using various fragment combinations (from different fragmentation methods) to dissect a molecule in a way that is most appropriate for the task at hand and render a transparent view on the structure-property relationships hypothesized by a molecular GNN.",
                "cite_spans": [
                    {
                        "start": 470,
                        "end": 473,
                        "text": "26,",
                        "ref_id": "BIBREF25"
                    }
                ],
                "ref_spans": [],
                "eq_spans": [],
                "section": "",
                "sec_num": null
            },
            {
                "text": "Four examples (i.e., aqueous solubility, genotoxicity, cardiotoxicity, and blood-brain barrier permeation for small molecules) are used to illustrate how chemists can benefit from using SME to rationalize the predictions of a reliable GNN model for the five aforementioned applications. Different from the previous GNN interpretation methods, SME can be used to explain property prediction models at the level of chemical intuitive fragments rather than at the level of atoms or bonds and hence provide meaningful SAR information to help medicinal chemists in structural optimization and de novo design.",
                "cite_spans": [],
                "ref_spans": [],
                "eq_spans": [],
                "section": "",
                "sec_num": null
            },
            {
                "text": "To verify the effectiveness of SME in explaining molecular property prediction models, four different consensus models (ESOL, Mutagenicity, hERG, and BBBP) are developed. As shown in Table 1 , each model achieved excellent performance on the test set. The ESOL model achieves the performance of R 2 of 0.927, and the Mutagenicity, hERG, and BBBP models also achieve sufficiently high ROC-AUC of 0.901, 0.862, and 0.919, respectively.",
                "cite_spans": [],
                "ref_spans": [
                    {
                        "start": 189,
                        "end": 190,
                        "text": "1",
                        "ref_id": "TABREF0"
                    }
                ],
                "eq_spans": [],
                "section": "Results",
                "sec_num": null
            },
            {
                "text": "To illustrate the benefits of working with an attribution analysis that conforms to chemist's working style, we further discuss five application scenarios in which SME can help us better utilize DL models for molecular property predictions and drug design. Under each scenario, we recommend different fragmentation schemes to go along with SME for analysis. A succinct overview is provided below. Scenarios 1. Mine the SAR for a specific molecule (i.e., local explanation): analyze the attributions of different substructures in a molecule, and it would be better to consider all fragmentation schemes (i.e., a combination of BRICS substructures, Murcko substructures and functional groups); Scenarios 2. Identify the most positive/negative components of a specific molecule: obtain the combined fragments with the most positive/negative attribution through the combination of BRICS substructures and Murcko substructures; Scenarios 3. Mine the SAR for the desired properties (i.e., global explanation) on a statistical basis: analyze the functional group attributions on the whole dataset; Scenarios 4. Provide guidance for structural optimization: compare the average attributions of different functional groups.",
                "cite_spans": [],
                "ref_spans": [],
                "eq_spans": [],
                "section": "Results",
                "sec_num": null
            },
            {
                "text": "Scenarios 5. Molecule generation for desired properties: recombination of BRICS substructures with SME attribution scores.",
                "cite_spans": [],
                "ref_spans": [],
                "eq_spans": [],
                "section": "Results",
                "sec_num": null
            },
            {
                "text": "Chemists have explored and broadly understood the effect of a large number of functional groups on water solubility. Hence, solubility is often used to validate model explanation methods and it provides a good setting for testing SME. By masking different substructures (BRICS substructures, Murcko substructures, and functional groups), SME can calculate the attributions of substructures to predictions to help us understand how the model predicts a particular molecule. For example, the visualization of the attributions for compound 1 is shown in Fig. 1a . The SMILES of compound 1 and the compounds used in the subsequent analysis can be seen in Supplementary Table 4 . As shown in Fig. 1a , hydroxyl is beneficial to enhance the model's prediction of hydrophilicity, while methyl, isopropyl, and cyclohexyl are beneficial to enhance the model's prediction of hydrophobicity, demonstrating that the attributions of the substructures are consistent with the known chemical knowledge. It can also be found that the attributions of the alkyl groups to hydrophobicity become higher as the number of carbon atoms increases (cyclohexyl>isopropyl>methyl), which also agrees with our chemical knowledge. In addition, through the combination of the BRICS substructures and Murcko substructures, SME can find the most hydrophobic substructure (the alkyl group) and the most hydrophilic substructure (hydroxyl). Although the atom mask in compound 1 can also help to understand the attribution of each atom to hydrophilicity and hydrophobicity, the substructure mask unambiguously reveals a more systematic trend from the data (and easier for chemists to generalize and relate to existing knowledge), such as illustrated in the earlier comment that we may draw the observation that increasing the number of carbon atoms can increase the hydrophobicity of the alkyl groups. As the complexity of compounds increases, the explanation of the substructure mask will be easier to capture the pattern/trend behind the data and to deduce more Only the functional groups that appear more than ten times in the dataset are included in Fig. 1 . Blue colors represent attributions lower than 0 and the substructure is favorable for hydrophilicity, while orange colors represent attributions higher than 0 and the substructure is unfavorable for hydrophilicity. meaningful chemical knowledge than the simple atom mask. As shown in Fig. 1b , the explanation based on the substructure mask are obviously more intuitive than the atom mask. It is reasonable that cyclopropyl and phenyl are hydrophobic while hydroxymethyl and methoxy are hydrophilic (Fig. 1b , BRICS substructure).",
                "cite_spans": [],
                "ref_spans": [
                    {
                        "start": 556,
                        "end": 558,
                        "text": "1a",
                        "ref_id": "FIGREF0"
                    },
                    {
                        "start": 671,
                        "end": 672,
                        "text": "4",
                        "ref_id": null
                    },
                    {
                        "start": 692,
                        "end": 694,
                        "text": "1a",
                        "ref_id": "FIGREF0"
                    },
                    {
                        "start": 2123,
                        "end": 2124,
                        "text": "1",
                        "ref_id": "FIGREF0"
                    },
                    {
                        "start": 2416,
                        "end": 2418,
                        "text": "1b",
                        "ref_id": "FIGREF0"
                    },
                    {
                        "start": 2632,
                        "end": 2634,
                        "text": "1b",
                        "ref_id": "FIGREF0"
                    }
                ],
                "eq_spans": [],
                "section": "SME attribution visualization of Aqueous solubility",
                "sec_num": null
            },
            {
                "text": "As shown above, different substructures enable us to more precisely describe the boundary of fragments responsible for the predicted molecular property. Moreover, functional groups are predefined molecular substructures and can be used to evaluate the impact of the specific functional groups in the whole dataset. The attributions of different functional groups in the whole ESOL dataset are shown in Fig. 1c , and the functional groups with less than ten occurrences in the dataset are not considered.",
                "cite_spans": [],
                "ref_spans": [
                    {
                        "start": 407,
                        "end": 409,
                        "text": "1c",
                        "ref_id": "FIGREF0"
                    }
                ],
                "eq_spans": [],
                "section": "Functional group attribution analysis and structure optimization of aqueous solubility",
                "sec_num": null
            },
            {
                "text": "As shown in Fig. 1c , SME tends to give positive attributions to common hydrophilic functional groups such as the hydroxyl (-O) and amino (-N) groups, and negative attributions to common hydrophobic groups such as the tert-butyl (-tBu) group. Hence, through the analysis of functional groups, SME can roughly assign the attribution of each functional group to the target property, and help to mine the SAR information.",
                "cite_spans": [],
                "ref_spans": [
                    {
                        "start": 17,
                        "end": 19,
                        "text": "1c",
                        "ref_id": "FIGREF0"
                    }
                ],
                "eq_spans": [],
                "section": "Functional group attribution analysis and structure optimization of aqueous solubility",
                "sec_num": null
            },
            {
                "text": "Since the Superfast Traversal, Optimization, Novelty, Exploration, and Discovery (STONED) method enables rapid exploration of chemical space without a pre-trained generative model, some interpretability methods combined with STONED can guide structure optimization 7, 28, 29 . And the functional group attribution generated by SME can also aid in structural optimization. Taking compound 1 as an example, the average attribution of different functional groups can be used to guide the optimization of its hydrophilicity. As shown in Fig. 1a , the Attribution_N of the methyl group is -0.488, and the attribution of the methyl group is -0.533. To structurally optimize compound 1 to change its water solubility, we can manually change the methyl group to a functional group in Fig. 1c . The structural optimization result is shown in Fig. 2 , demonstrating that the aqueous solubility of different compounds predicted by the model is highly correlated with the average attributions. The Spearman correlation coefficient between the average attributions and predictions is 0.882 and the p-value is less than 0.05, indicating a significant positive correlation between the average attributions and predictions. Furthermore, by changing the methyl group to a functional group with a smaller average attribution, two of the three molecules are predicted to be less hydrophilic than compound 1, while changing the methyl group to a functional group with a larger average attribution, 13 of the 14 molecules are predicted to be more hydrophilic than compound 1. Hence, the above results demonstrate that SME does give a reasonable explanation. With the change of different functional groups, we can roughly sketch out the trend of the predictions by the model according to the average attributions, and then guide structural optimization.",
                "cite_spans": [
                    {
                        "start": 265,
                        "end": 267,
                        "text": "7,",
                        "ref_id": "BIBREF6"
                    },
                    {
                        "start": 268,
                        "end": 271,
                        "text": "28,",
                        "ref_id": "BIBREF27"
                    }
                ],
                "ref_spans": [
                    {
                        "start": 538,
                        "end": 540,
                        "text": "1a",
                        "ref_id": "FIGREF0"
                    },
                    {
                        "start": 781,
                        "end": 783,
                        "text": "1c",
                        "ref_id": "FIGREF0"
                    },
                    {
                        "start": 838,
                        "end": 839,
                        "text": "2",
                        "ref_id": "FIGREF1"
                    }
                ],
                "eq_spans": [],
                "section": "Functional group attribution analysis and structure optimization of aqueous solubility",
                "sec_num": null
            },
            {
                "text": "Mutagenicity is of great concern in drug development due to its hazards to human health. Some toxicophores and detoxifying groups are shown in Supplementary Fig. 1 . The attributions of compound 3 based on different types of substructures are shown in Fig. 3 . A positive attribution means that the substructure is favorable for toxicity, and a negative attribution means that the substructure is considered detoxifying. As shown in Fig. 3 , the nitro, amino, and quinone groups are beneficial to enhance the model's prediction of toxicity, while the carboxyl group is beneficial to enhance the model's prediction of non-toxicity. This is consistent with the existing literature reports that the aromatic nitro, aromatic amino, and quinone groups are identified toxicophores and the carboxyl group is an identified detoxifying group (Supplementary Fig. 1 ). In addition, through the combination of the BRICS substructures and Murcko substructures, SME can find the most toxic substructure (the aromatic nitro, aromatic amino, and quinone groups) and the most detoxifying substructure (the carboxyl group) as shown in Fig. 3 .",
                "cite_spans": [],
                "ref_spans": [
                    {
                        "start": 162,
                        "end": 163,
                        "text": "1",
                        "ref_id": "FIGREF0"
                    },
                    {
                        "start": 257,
                        "end": 258,
                        "text": "3",
                        "ref_id": "FIGREF2"
                    },
                    {
                        "start": 438,
                        "end": 439,
                        "text": "3",
                        "ref_id": "FIGREF2"
                    },
                    {
                        "start": 853,
                        "end": 854,
                        "text": "1",
                        "ref_id": "FIGREF0"
                    },
                    {
                        "start": 1122,
                        "end": 1123,
                        "text": "3",
                        "ref_id": "FIGREF2"
                    }
                ],
                "eq_spans": [],
                "section": "SME attribution visualization of mutagenicity",
                "sec_num": null
            },
            {
                "text": "As shown in Fig. 3 , compared with the regression problem (ESOL), the model assigns less attributions to fragments for the binary classification problem, and even only assigns an attribution of 0.003 to the amino group. The reason is that there are multiple toxic groups in some molecules, for example, there are three toxic groups (i.e., the aromatic nitro, aromatic amino and quinone groups) in compound 3. After removing a nitro group, the molecule still contains two toxic groups (aromatic nitro and quinone groups), so that the model still predicts the remaining part to be toxic. That is, Y sub \u2248 Y \u2248 1, which also causes SME to assign an attribution close to 0 to the toxic group. In short, this is why SME assigns an attribution close to 0 to the nitro group.",
                "cite_spans": [],
                "ref_spans": [
                    {
                        "start": 17,
                        "end": 18,
                        "text": "3",
                        "ref_id": "FIGREF2"
                    }
                ],
                "eq_spans": [],
                "section": "The combination can compensate for the flaws of SME in the classification problem",
                "sec_num": null
            },
            {
                "text": "Compounds 4, 5, and 6 are used to better illustrate the above flaws of SME. As shown in Supplementary Fig. 2 , SME assigns the attributions close to 0 to the nitro and amino groups in compounds 4 and 5, but assigns a higher attribution value to the phenyl ring. The reason is that after removing the nitro and amino groups, the remaining part of the molecule still contains a toxic group, but when the phenyl ring is removed, the remaining part of the molecule no longer retains any identified toxicophores. This leads SME to judge that the phenyl ring is a very important toxic group, while the nitro and amino groups are not. The azide group is also an identified toxicophore. In compound 6, SME no longer judges the phenyl ring to be an important toxic group, and the reason is that the molecule still retains the azide group as a toxic group after the phenyl ring is removed. The above examples illustrate that SME will underestimate the attributions of toxicophore in molecules in the classification problem, especially when the molecule contains multiple toxic groups. Fortunately, by using our proposed method of taking fragment combinations for attribution analysis, we can largely fix the observed flaws when only individual fragments are considered. As shown in Fig. 3 and Supplementary Fig. 2 , the combination of fragments is always able to find all the toxic groups within the molecules tested in this study.",
                "cite_spans": [],
                "ref_spans": [
                    {
                        "start": 107,
                        "end": 108,
                        "text": "2",
                        "ref_id": "FIGREF1"
                    },
                    {
                        "start": 1277,
                        "end": 1278,
                        "text": "3",
                        "ref_id": "FIGREF2"
                    },
                    {
                        "start": 1302,
                        "end": 1303,
                        "text": "2",
                        "ref_id": "FIGREF1"
                    }
                ],
                "eq_spans": [],
                "section": "The combination can compensate for the flaws of SME in the classification problem",
                "sec_num": null
            },
            {
                "text": "Moreover, we also compare the explanation results with the reported GNN explanation methods. The reported explanation results of compound 7 are from Yuan's research and the explanation results for different explanation methods are shown in Fig. 4 . Compared with the identified toxicophores in Supplementary Fig. 1 , compound 7 contains the toxicophores of aromatic nitro and polycyclic aromatic system. The reported methods have only identified a single benzene ring (SubgraphX and MCTS_GNN) or some discrete bonds (PGExplainer and GNNExplainer), and the results do not provide any help in understanding that polyaromatic rings are toxic fragments. Obviously, SME provides more reasonable explanation results than the reported methods through the identification of the attributions to more complete fragments rather than some discrete bonds. As shown in Fig. 4 , SME can find all toxic substructures (aromatic nitro and polycyclic aromatic system) in compound 7.",
                "cite_spans": [],
                "ref_spans": [
                    {
                        "start": 245,
                        "end": 246,
                        "text": "4",
                        "ref_id": "FIGREF3"
                    },
                    {
                        "start": 313,
                        "end": 314,
                        "text": "1",
                        "ref_id": "FIGREF0"
                    },
                    {
                        "start": 860,
                        "end": 861,
                        "text": "4",
                        "ref_id": "FIGREF3"
                    }
                ],
                "eq_spans": [],
                "section": "The combination can compensate for the flaws of SME in the classification problem",
                "sec_num": null
            },
            {
                "text": "The attributions of different functional groups in the whole Mutagenicity dataset are shown in Fig. 5 and the functional groups with less than ten occurrences are not considered. As shown in Fig. 5 , the functional groups with the positive attributions are often the components of the identified toxic groups, such as nitroso (-N = O), nitro (-NO 2 ) and amino (-N). In addition, the functional groups with the However, as shown in Supplementary Fig. 1 , the isocyanate group is identified as a toxicophore, but SME always assigns negative attribution to the isocyanate group. And we explore what causes SME to make judgments contrary to the expert knowledge. There are only ten molecules in the dataset containing such functional groups, nine in the training set and one in the test set. In addition, only two of the nine molecules in the training set are toxic, while seven are non-toxic. The small amount of data and highly imbalanced labels cause the model to misjudge the isocyanate group as a detoxifying group. Moreover, the model also incorrectly predicts the only positive molecule in the test set that contains this group as a non-toxic molecule. Combining the SME explanation results and expert knowledge, we are able to discover problems that the model has learned the wrong information, and then provide directions to optimize the model. In other words, careful analysis on SME explanations can help us to judge if the model's predictions for the molecules containing certain structures are unreliable, and more similar molecules should be added to the training set to further improve the model's ability to predict such molecules as done in an active learning loop to improve model reliability with small amount of highly relevant data. For example, to optimize the prediction ability of the mutagenicity model for molecules containing the isocyanate group, it is necessary to add molecules containing the isocyanate group to the training set and provide more balanced data labels.",
                "cite_spans": [],
                "ref_spans": [
                    {
                        "start": 100,
                        "end": 101,
                        "text": "5",
                        "ref_id": "FIGREF4"
                    },
                    {
                        "start": 196,
                        "end": 197,
                        "text": "5",
                        "ref_id": "FIGREF4"
                    },
                    {
                        "start": 451,
                        "end": 452,
                        "text": "1",
                        "ref_id": "FIGREF0"
                    }
                ],
                "eq_spans": [],
                "section": "Functional group attribution analysis and structure optimization of Mutagenicity",
                "sec_num": null
            },
            {
                "text": "We also evaluate whether SME could guide the structural optimization of Mutagenicity, and the results are shown in Supplementary Fig. 2 . We sequentially replace the toxic functional groups in compounds 4, 5, and 6 (the amino, nitro, and isocyanate groups) with detoxifying groups (sulfonyl hydroxide, sulfonamide, and trifluoromethyl). As shown in Supplementary Fig. 2 , after structural optimization, the prediction results of the model all change from close to 1 to close to 0, suggesting that SME really reflects how the model makes predictions.",
                "cite_spans": [],
                "ref_spans": [
                    {
                        "start": 134,
                        "end": 135,
                        "text": "2",
                        "ref_id": "FIGREF1"
                    },
                    {
                        "start": 368,
                        "end": 369,
                        "text": "2",
                        "ref_id": "FIGREF1"
                    }
                ],
                "eq_spans": [],
                "section": "Functional group attribution analysis and structure optimization of Mutagenicity",
                "sec_num": null
            },
            {
                "text": "Different from mutagenicity, there are no clearly identified toxicophores for hERG toxicity. Fortunately, in previous works, medicinal chemists have summarized a large number of strategies to reduce hERG toxicity [30] [31] [32] [33] . Therefore, we explore whether SME can rediscover these optimization strategies to validate SME. The attributions of functional groups for hERG toxicity are shown in Fig. 6 , and a positive attribution means that the substructure is favorable to toxicity while a negative attribution means that the substructure is unfavorable to toxicity. Introducing the hydroxyl (-O) groups and acidic groups (-C( = O)O) are common optimization strategies to reduce hERG toxicity, and SME also considers that the hydroxyl and acidic groups are unfavorable to hERG toxicity as shown in Fig. 6 . Reducing lipophilicity is also a commonly used strategy to reduce hERG toxicity 32, 33 . To verify whether SME mine this SAR, we evaluate the correlation of the hERG's functional group attributions and the ESOL's functional group attributions. As shown in Fig. 7 , they are highly negatively correlated with a spearman correlation coefficient of -0.86 and a pvalue of less than 0.05, indicating a high correlation between hERG toxicity and lipophilicity. ",
                "cite_spans": [
                    {
                        "start": 213,
                        "end": 217,
                        "text": "[30]",
                        "ref_id": "BIBREF29"
                    },
                    {
                        "start": 218,
                        "end": 222,
                        "text": "[31]",
                        "ref_id": "BIBREF30"
                    },
                    {
                        "start": 223,
                        "end": 227,
                        "text": "[32]",
                        "ref_id": "BIBREF31"
                    },
                    {
                        "start": 228,
                        "end": 232,
                        "text": "[33]",
                        "ref_id": "BIBREF32"
                    },
                    {
                        "start": 894,
                        "end": 897,
                        "text": "32,",
                        "ref_id": "BIBREF31"
                    }
                ],
                "ref_spans": [
                    {
                        "start": 405,
                        "end": 406,
                        "text": "6",
                        "ref_id": "FIGREF5"
                    },
                    {
                        "start": 810,
                        "end": 811,
                        "text": "6",
                        "ref_id": "FIGREF5"
                    },
                    {
                        "start": 1075,
                        "end": 1076,
                        "text": "7",
                        "ref_id": "FIGREF6"
                    }
                ],
                "eq_spans": [],
                "section": "SME can reveal the hERG optimization strategies",
                "sec_num": null
            },
            {
                "text": "In the above structural optimization, the examples are consistent with the model prediction results. Changing functional groups with desired attributions can yield molecules with desired properties predicted by models, as exemplified in Fig. 2 and Supplementary Fig. 2 . Here we find some real-world structural optimization examples for hERG toxicity to evaluate whether they meet the guidance provided by the average attributions derived from SME. Since a positive attribution means that the substructure is potentially more toxic while a negative attribution means that the substructure is 'detoxifying', SME can naturally provide three structural optimization strategies to reduce hERG toxicity as follows: 1. adding a functional group with an average attribution <0; 2. removing a functional group with an average attribution >0; 3. replacing a functional group with a more negative attribution. Some realworld structural optimization examples confirm the rationality of the above structural optimization strategies.",
                "cite_spans": [],
                "ref_spans": [
                    {
                        "start": 242,
                        "end": 243,
                        "text": "2",
                        "ref_id": "FIGREF1"
                    },
                    {
                        "start": 267,
                        "end": 268,
                        "text": "2",
                        "ref_id": "FIGREF1"
                    }
                ],
                "eq_spans": [],
                "section": "Examples of structural optimization for hERG toxicity in the real world",
                "sec_num": null
            },
            {
                "text": "As shown in Fig. 8a , adding a carboxyl group with the average attribution of -0.465 to compound 8, the hERG toxicity of the compound decreases (IC 50 from 0.8 \u03bcM to 76.8 \u03bcM) 34 . And adding a amide group with average attribution of -0.069 to compound 8 can also reduce the hERG toxicity of the compound (IC 50 from 0.8 \u03bcM to 17.1 \u03bcM) 34 . The above examples can demonstrate the effectiveness of adding a functional group with an average attribution <0 to reduce hERG toxicity. The second structural optimization strategy is to remove a functional group with an average attribution >0 to reduce hERG toxicity. As shown in Fig. 8b , removing a methoxy group with an average attribution of 0.021 to compound 11 can reduce the hERG toxicity of the compound (IC 50 from 0.35 \u03bcM to 0.76 \u03bcM) 35 . Removing a chlorinated group with an average attribution of 0.036 can reduce the hERG toxicity of the compound (IC 50 from 0.85 \u03bcM to 5.49 \u03bcM) 35 . Another structural optimization strategy is replacing a functional group with a more negative attribution to reduce hERG toxicity. As shown in Fig. 8a , by replacing the amide group in compound 10 with a more negative carboxylic group to obtain compound 9, the hERG toxicity is significantly reduced (IC 50 from 17.1 \u03bcM to 76.8 \u03bcM). Moreover, replacing the cyano group with the methylsulphonyl group (having a more negative attribution) reduces hERG toxicity 36 . As shown in Fig. 8c , replacing the amino group with the methylamide group (having a more negative attribution) also reduces the hERG toxicity (IC 50 from 0.12 \u03bcM to 2.6 \u03bcM) 37 . In addition, Rao et al. proposed a subjective method to evaluate the explanatory power of different interpretability methods and provide some hERG cliff molecular pairs. Some hERG cliff molecular pairs that did not appear in our training set also verify the effectiveness of SME in guiding structural optimization, and these results are shown in Supplementary Fig. 3 38 . All in all, the above real-world examples can demonstrate that SME could guide the structural optimization of hERG toxicity.",
                "cite_spans": [],
                "ref_spans": [
                    {
                        "start": 17,
                        "end": 19,
                        "text": "8a",
                        "ref_id": "FIGREF7"
                    },
                    {
                        "start": 627,
                        "end": 629,
                        "text": "8b",
                        "ref_id": "FIGREF7"
                    },
                    {
                        "start": 1087,
                        "end": 1089,
                        "text": "8a",
                        "ref_id": "FIGREF7"
                    },
                    {
                        "start": 1420,
                        "end": 1422,
                        "text": "8c",
                        "ref_id": "FIGREF7"
                    },
                    {
                        "start": 1947,
                        "end": 1948,
                        "text": "3",
                        "ref_id": "FIGREF2"
                    }
                ],
                "eq_spans": [],
                "section": "Examples of structural optimization for hERG toxicity in the real world",
                "sec_num": null
            },
            {
                "text": "The generation of molecules with desired properties has attracted the attention of computational chemists and a lot of excellent works based on DL has emerged in recent years. Through the BRICS fragments endowed with the attributions predicted by SME, we provide a molecular generation method that does not require any conditional generative model to generate molecules with target properties. BRICS fragments are originally designed to be recombined for molecular generation. Since SME can assign the attributions of desired properties to different BRICS fragments, it is natural to recombine the BRICS fragments with desired properties to generate molecules with desired properties.",
                "cite_spans": [],
                "ref_spans": [],
                "eq_spans": [],
                "section": "Attribution-based molecular generation for desired properties",
                "sec_num": null
            },
            {
                "text": "The \"positive BRICS fragments\" (attribution>0) and \"negative BRICS fragments\" (attribution<0) are recombined to yield 3000 molecules, and the desired properties of these molecules are predicted. For different properties, the positive fragments include hydrophilic BRICS fragments, Mutag-toxic BRICS fragments and hERG-toxic BRICS fragments, while the negative fragments include hydrophobic BRICS fragments, Non-Mutag-toxic BRICS fragments and Non-hERG-toxic BRICS fragments. As shown in Fig. 9a , the distribution of the desired properties of the molecules generated by the recombination of the fragments with the desired attributions is indeed as expected. However, it can also be seen that there is still a partial intersection between the two classes of generated molecules, and even some molecules composed entirely of so-called \"non-toxic fragments\" are still predicted to be toxic. The main reason is that the attributions given by SME only represents that of the fragments in the current molecules, and their attributions may even be completely opposite in the new molecules. As shown in Fig. 5 , the same fragment may also exhibit different attributions in different molecules. A simple solution to this problem is to sample fragments that are more likely to exhibit negative attributions throughout the dataset, since existing data suggests that these fragments tend to be non-toxic in the vast majority of existing molecules. And these fragments will also more easily retain their non-toxic properties in new molecules, such as sulfonyl hydroxide (-SO3H) and trifluoromethyl (-CF3) for mutagenicity toxicity.",
                "cite_spans": [],
                "ref_spans": [
                    {
                        "start": 492,
                        "end": 494,
                        "text": "9a",
                        "ref_id": "FIGREF9"
                    },
                    {
                        "start": 1100,
                        "end": 1101,
                        "text": "5",
                        "ref_id": "FIGREF4"
                    }
                ],
                "eq_spans": [],
                "section": "Attribution-based molecular generation for desired properties",
                "sec_num": null
            },
            {
                "text": "Hence, in order to reduce the overlap between the two classes of generated molecules, we only take the top 20% fragments with the smallest attributions less than 0 as the negative fragments, and only the top 20% fragments with the largest attributions higher than 0 as the positive fragments. A total of 3000 negative molecules and 3000 positive molecules are generated for 3 different tasks, respectively, and the corresponding properties are predicted. As shown in Fig. 9b , the overlap between the two classes of generated molecules is significantly reduced, demonstrating the effectiveness of the above strategy.",
                "cite_spans": [],
                "ref_spans": [
                    {
                        "start": 472,
                        "end": 474,
                        "text": "9b",
                        "ref_id": "FIGREF9"
                    }
                ],
                "eq_spans": [],
                "section": "Attribution-based molecular generation for desired properties",
                "sec_num": null
            },
            {
                "text": "In addition, we also explore the application of attribution-based molecular generation for multiple desired properties. We merge the fragments co-existing in the top 20% Non-Mutag-toxic and Non-hERGtoxic fragments to obtain the Non-Mutag-toxic&Non-hERG-toxic fragments. 3000 molecules are generated from the Non-Mutag-tox-ic&Non-hERG-toxic fragments, and the predictions of the 3000 molecules from the Mutagenicity model and the hERG model can be seen in Fig. 9c . As shown in Fig. 9c , the vast majority of the 3000 generated molecules are predicted to be non-toxic, illustrating the potential of the attribution-based molecular generation approach in generating molecules with desired properties.",
                "cite_spans": [],
                "ref_spans": [
                    {
                        "start": 460,
                        "end": 462,
                        "text": "9c",
                        "ref_id": "FIGREF9"
                    },
                    {
                        "start": 482,
                        "end": 484,
                        "text": "9c",
                        "ref_id": "FIGREF9"
                    }
                ],
                "eq_spans": [],
                "section": "Attribution-based molecular generation for desired properties",
                "sec_num": null
            },
            {
                "text": "In this section, we show that SME (with its enforced attribution to chemically meaningful fragments) allows one to more easily establish a deeper understanding on why certain fragments make the molecule more ideal for the target property. This deeper understanding is achieved by connecting fragments and some characteristic physiochemical properties that is conceptually known to be relevant to the property of interest, for instance, BBBP in this case.",
                "cite_spans": [],
                "ref_spans": [],
                "eq_spans": [],
                "section": "How can SME establish SAR information with deeper explanations",
                "sec_num": null
            },
            {
                "text": "Through the analysis of functional group attribution generated by SME, we can construct the desired relationship between molecular functional groups and the BBBP as shown in above Fig. 10a . Similarly, by constructing different prediction models of fundamental physicochemical properties, we can construct the desired relationship between molecular functional groups and the fundamental physicochemical properties. Subsequently, we then establish the relationship between BBBP and the fundamental physicochemical properties, providing a complementary perspective on what molecular properties (substructure or physiochemical attributions) hold the key to having the desired properties. Four fundamental physicochemical properties include molecular weight (MW), topological polar surface area (TPSA), lipid solubility (LogP) and the number of hydrogen bond donor (HBDs) calculated by RDKIT package are used as labels to construct different prediction models in this case. The overall process is shown in Fig. 10a and the detailed result can be seen in Fig. 10b-e . The performance of fundamental physicochemical property models can be seen in Supplementary Table 1 . As shown in Fig. 10b-e , SME does not find a definite correlation between BBBP and MW. Moreover, SME finds that BBBP is positively correlated with LogP and negatively correlated with HBDs and TPSA, which is consistent with the results reported in previous studies. The above results demonstrate that chemists can mine SAR information through SME and use this valuable information to further expose favorable physiochemical properties these molecules must possess. Furthermore, converting information from favorable molecular substructures to favorable physiochemical/ biochemical properties by SME is an abstraction that may actually inspire further understanding of complex phenomena as done by Mittal, A. et al. 39 .",
                "cite_spans": [],
                "ref_spans": [
                    {
                        "start": 185,
                        "end": 188,
                        "text": "10a",
                        "ref_id": "FIGREF10"
                    },
                    {
                        "start": 1007,
                        "end": 1010,
                        "text": "10a",
                        "ref_id": "FIGREF10"
                    },
                    {
                        "start": 1055,
                        "end": 1060,
                        "text": "10b-e",
                        "ref_id": "FIGREF10"
                    },
                    {
                        "start": 1161,
                        "end": 1162,
                        "text": "1",
                        "ref_id": "TABREF0"
                    },
                    {
                        "start": 1182,
                        "end": 1187,
                        "text": "10b-e",
                        "ref_id": "FIGREF10"
                    }
                ],
                "eq_spans": [],
                "section": "How can SME establish SAR information with deeper explanations",
                "sec_num": null
            },
            {
                "text": "In this study, we propose an intuitive SME to explain GNN models for molecular property predictions. Combining different welldesigned molecular fragmentation methods (BRICS substructures, Murcko substructures, and functional groups), SME provides intuitive and chemistry-compatible explanations for all four tasks considered in this study. By analyzing the attributions of functional groups assigned by SME across the entire dataset, we are able to explore how functional groups affect model predictions and infer structure-activity relationships. More importantly, the attribution analysis of functional groups can also provide guidance for structural optimization, and the experimental results and real-world examples confirm the validity and rationality of the attribution-based guidance. In addition, SME can also help to diagnose problems affecting a model's reliability and provide directions to further improve the predictive model. For example, the attribution of the isocyanate group assigned by SME based on the consensus mutagenicity prediction model is inconsistent with the existing expert knowledge, and we could easily identify the problem that the training data containing such functional groups is insufficient and unbalanced which may cause the model being unable to make correct predictions for molecules containing this functional group. Moreover, the recombination of the BRICS fragments with the attributions assigned by SME can be used to generate molecules with desired properties, which provides a way to efficiently generate molecules with desired properties that does not require training a generative model. Just like all other explanation methods for deep learning models, SME also possesses several limitations. First, since SME (and other GNN-based interpretation methods) aims to explain what the GNN model has learned from the data, it is difficult for SME to mine reasonable SAR information when the GNN model has not learned the true or complete causality due to data paucity or bias. As a noteworthy example, tautomers present a challenge in the pursuit of accurate molecular property predictions and, accordingly, has implications for the effectiveness of SME. Second, as chemically intuitive explanations are enforced, intrinsically chemically meaningless patterns learned from data artifacts may remain concealed. Lastly, the current version of SME only supports the three substructures of BRICS, Murcko, and functional groups, and does not allow the assessment of some other substructures such as bioisosteres. Irrespective of these limitations (some can be easily overcome such as the last point mentioned above), SME provides intuitive and insightful interpretability for chemists based on chemically meaningful substructures. As most existing attribution methods for molecular GNNs in chemistry are directly borrowed from other fields and lacks the kind of chemical intuition that SME insists by design, we believe its benefits outweigh its drawbacks. Particularly, we demonstrate how SME help chemists in 4 key druggability properties tasks (ESOL, Mutagenicity, hERG and BBBP). In sum, SME is a tool with great potential to assist chemists to gain an intuitive understanding of why a GNN model makes a certain prediction, relating structural and physiochemical properties when it is appropriate to do so, and mine SAR information for structure optimization and de novo design.",
                "cite_spans": [],
                "ref_spans": [],
                "eq_spans": [],
                "section": "Discussion",
                "sec_num": null
            },
            {
                "text": "In order to verify the effectiveness of SME in explaining the predictions from a GNN model, we conduct experiments on four different molecular property datasets, concerning aqueous solubility (ESOL), mutagenicity, hERG-related cardiotoxicity and blood-brain barrier permeation (BBBP). We briefly give a short introduction to these four properties.",
                "cite_spans": [],
                "ref_spans": [],
                "eq_spans": [],
                "section": "Datasets",
                "sec_num": null
            },
            {
                "text": "Aqueous solubility is essential for drug candidates and is one of the key physical properties of interest for medicinal chemists 40 . The flux of drugs across the intestinal membrane is proportional to the concentration gradient between the intestinal lumen and blood, so drugs with poor water solubility may result in poor absorption even if the permeation rate is high 40 . Therefore, accurate prediction of aqueous solubility will help optimize the absorption properties of drug candidates, and a large number of aqueous solubility prediction models based on ML have been reported [41] [42] [43] [44] . Although accurate prediction of water solubility remains a difficult problem, chemists have explored and broadly understood the effect of a large number of functional groups on water solubility 42 . Hence, solubility is often used to validate model explanation methods and it provides a good setting for testing SME 7, 45 .",
                "cite_spans": [
                    {
                        "start": 584,
                        "end": 588,
                        "text": "[41]",
                        "ref_id": "BIBREF40"
                    },
                    {
                        "start": 589,
                        "end": 593,
                        "text": "[42]",
                        "ref_id": "BIBREF41"
                    },
                    {
                        "start": 594,
                        "end": 598,
                        "text": "[43]",
                        "ref_id": "BIBREF42"
                    },
                    {
                        "start": 599,
                        "end": 603,
                        "text": "[44]",
                        "ref_id": "BIBREF43"
                    },
                    {
                        "start": 922,
                        "end": 924,
                        "text": "7,",
                        "ref_id": "BIBREF6"
                    }
                ],
                "ref_spans": [],
                "eq_spans": [],
                "section": "Datasets",
                "sec_num": null
            },
            {
                "text": "Mutagenicity reflects the ability of a compound to induce mutations in DNA. Many computational approaches have been developed in recent years to predict the mutagenicity of compounds in the early stage of drug development [46] [47] [48] [49] [50] . A large number of toxicophores and detoxifying groups have been identified and reported, and hence mutagenicity constitutes another popular setup for verifying whether ML models capture essential structure-property relationships to support their predictions 46, 48, [51] [52] [53] .",
                "cite_spans": [
                    {
                        "start": 222,
                        "end": 226,
                        "text": "[46]",
                        "ref_id": "BIBREF45"
                    },
                    {
                        "start": 227,
                        "end": 231,
                        "text": "[47]",
                        "ref_id": "BIBREF46"
                    },
                    {
                        "start": 232,
                        "end": 236,
                        "text": "[48]",
                        "ref_id": "BIBREF47"
                    },
                    {
                        "start": 237,
                        "end": 241,
                        "text": "[49]",
                        "ref_id": "BIBREF48"
                    },
                    {
                        "start": 242,
                        "end": 246,
                        "text": "[50]",
                        "ref_id": "BIBREF49"
                    },
                    {
                        "start": 507,
                        "end": 510,
                        "text": "46,",
                        "ref_id": "BIBREF45"
                    },
                    {
                        "start": 511,
                        "end": 514,
                        "text": "48,",
                        "ref_id": "BIBREF47"
                    },
                    {
                        "start": 515,
                        "end": 519,
                        "text": "[51]",
                        "ref_id": "BIBREF50"
                    },
                    {
                        "start": 520,
                        "end": 524,
                        "text": "[52]",
                        "ref_id": "BIBREF51"
                    },
                    {
                        "start": 525,
                        "end": 529,
                        "text": "[53]",
                        "ref_id": "BIBREF52"
                    }
                ],
                "ref_spans": [],
                "eq_spans": [],
                "section": "Datasets",
                "sec_num": null
            },
            {
                "text": "Cardiotoxicity is another task that we consider, a highly crucial factor in drug design. Undesired hERG-related cardiotoxicity is one of the main reasons for drug candidate failures and drug withdrawal from the market 54, 55 . And a number of hERG inhibition prediction models have been developed in recent years 46, [56] [57] [58] . We will use this important property to illustrate how a chemistry-compatible explanation method, such as the proposed SME, not only rationalizing how a model makes predictions but also provides actionable insights to help us improve the design of drug candidates. As repeatedly implied in the introduction, a good explanation method should offer more than just a verification tool.",
                "cite_spans": [
                    {
                        "start": 218,
                        "end": 221,
                        "text": "54,",
                        "ref_id": "BIBREF53"
                    },
                    {
                        "start": 313,
                        "end": 316,
                        "text": "46,",
                        "ref_id": "BIBREF45"
                    },
                    {
                        "start": 317,
                        "end": 321,
                        "text": "[56]",
                        "ref_id": "BIBREF55"
                    },
                    {
                        "start": 322,
                        "end": 326,
                        "text": "[57]",
                        "ref_id": "BIBREF56"
                    },
                    {
                        "start": 327,
                        "end": 331,
                        "text": "[58]",
                        "ref_id": "BIBREF57"
                    }
                ],
                "ref_spans": [],
                "eq_spans": [],
                "section": "Datasets",
                "sec_num": null
            },
            {
                "text": "BBBP is another classic problem in computational chemistry. Since brain drugs need to penetrate the blood-brain barrier, the BBB permeability has been investigated in detail and many BBBP prediction models have been developed in recent years [59] [60] [61] . In this study, we consider BBBP datasets as an example to illustrate how one can further push the interpretation method discussed so far to generate a deeper explanation. As discussed later, not only will we highlight important fragments responsible for a molecule's BBBP, but also provide a rationale on how the responsible fragment determines some critical physiochemical properties of a molecule that subsequently affects its BBBP.",
                "cite_spans": [
                    {
                        "start": 242,
                        "end": 246,
                        "text": "[59]",
                        "ref_id": "BIBREF58"
                    },
                    {
                        "start": 247,
                        "end": 251,
                        "text": "[60]",
                        "ref_id": "BIBREF59"
                    },
                    {
                        "start": 252,
                        "end": 256,
                        "text": "[61]",
                        "ref_id": "BIBREF60"
                    }
                ],
                "ref_spans": [],
                "eq_spans": [],
                "section": "Datasets",
                "sec_num": null
            },
            {
                "text": "The detail on these four datasets is summarized in Supplementary Table 2 and further detail on the data curation can be found in Supplementary Table 3 . In addition, the canonical SMILES of the compounds for analysis are shown in Supplementary Table 4 .",
                "cite_spans": [],
                "ref_spans": [
                    {
                        "start": 71,
                        "end": 72,
                        "text": "2",
                        "ref_id": null
                    },
                    {
                        "start": 149,
                        "end": 150,
                        "text": "3",
                        "ref_id": null
                    },
                    {
                        "start": 250,
                        "end": 251,
                        "text": "4",
                        "ref_id": null
                    }
                ],
                "eq_spans": [],
                "section": "Datasets",
                "sec_num": null
            },
            {
                "text": "Under many real-world settings for molecular property predictions, a common practice is to integrate the predictions from multiple models. Thus, in this study, we first build 10 relational graph convolution networks (RGCN) models based on different random seeds for initialization and then construct the consensus model by integrating the 10 RGCN models. The mean of the ten individual predictions will be used as the output of the final consensus model.",
                "cite_spans": [],
                "ref_spans": [],
                "eq_spans": [],
                "section": "Substructure mask explanation",
                "sec_num": null
            },
            {
                "text": "In recent years, GNN has attracted increasing attention in molecular property predictions due to its strong predictive power on graphstructured data. All GNN variants, such as graph convolution neural networks (GCN) 62 , graph attention networks (GAT) 63 , attentive FP 64 , and directed message-passing neural networks (D-MPNN) 3 , can be regarded as the special cases of differentiable message-passing frameworks. RGCN is an extension of the standard GCN by introducing edge features to enrich the messages used to update the hidden states in the network and has achieved excellent performance in link predictions and entity classification 65 . The propagation rule for each node v is calculated via",
                "cite_spans": [],
                "ref_spans": [],
                "eq_spans": [],
                "section": "Substructure mask explanation",
                "sec_num": null
            },
            {
                "text": "EQUATION",
                "cite_spans": [],
                "ref_spans": [],
                "eq_spans": [
                    {
                        "start": 0,
                        "end": 8,
                        "text": "EQUATION",
                        "ref_id": "EQREF",
                        "raw_str": "h \u00f0l + 1\u00de \u03c5 = \u03c3 X r\u03f5R X u\u03f5N r \u03c5 W \u00f0l\u00de r h \u00f0l\u00de u + W \u00f0l\u00de 0 h \u00f0l\u00de \u03c5 0 @ 1 A",
                        "eq_num": "\u00f01\u00de"
                    }
                ],
                "section": "Substructure mask explanation",
                "sec_num": null
            },
            {
                "text": "where h l + 1 \u00f0 \u00de \u03bd",
                "cite_spans": [],
                "ref_spans": [],
                "eq_spans": [],
                "section": "Substructure mask explanation",
                "sec_num": null
            },
            {
                "text": "is the state vector of target node \u03bd after l + 1 iterations, N r v denotes the neighbors of node \u03bd under the relation (edge) r\u03f5R and R denotes the set of edge types. The neighbors of node \u03bd refers to the nodes directly connected to node \u03bd. \u03c3\u00f0 \u00de is an element-wise activation function, and ReLU\u00f0 \u00de is adopted in this study. W l \u00f0 \u00de r is the weight for neighbor node u connecting to node v by an edge attributed with the relation r\u03f5R, and W l \u00f0 \u00de 0 is the weight for target node v. As shown above, the edge information is explicitly incorporated into a RGCN under the relation r\u03f5R. The weight W l \u00f0 \u00de r is a linear combination of the basis transformation. The initial node and edge representation can be found in Supplementary Table 5 . The initial node (atom) and edge (bond) information used in RGCN.",
                "cite_spans": [],
                "ref_spans": [
                    {
                        "start": 731,
                        "end": 732,
                        "text": "5",
                        "ref_id": null
                    }
                ],
                "eq_spans": [],
                "section": "Substructure mask explanation",
                "sec_num": null
            },
            {
                "text": "By aggregating the information from each node through attention pooling, the embedding of a molecule can be obtained, and the molecular properties can be predicted by feeding the molecular embedding through three fully connected (FC) layers. The attention pooling is defined as follows:",
                "cite_spans": [],
                "ref_spans": [],
                "eq_spans": [],
                "section": "Substructure mask explanation",
                "sec_num": null
            },
            {
                "text": "EQUATION",
                "cite_spans": [],
                "ref_spans": [],
                "eq_spans": [
                    {
                        "start": 0,
                        "end": 8,
                        "text": "EQUATION",
                        "ref_id": "EQREF",
                        "raw_str": "\u03c9 v = sigmoid\u00f0W \u00c1h v + bias\u00de \u00f0 2\u00de molecular embedding = X N v = 1 \u00f0\u03c9 v \u00c1h v \u00de",
                        "eq_num": "\u00f03\u00de"
                    }
                ],
                "section": "Substructure mask explanation",
                "sec_num": null
            },
            {
                "text": "where W and bias are the trainable matrixes of the linear transformations in model training, N is the number of nodes for a molecular graph, sigmoid\u00f0 \u00de is an activation function that limits the attention weight \u03c9 v of each node to between 0 and 1, \u03c9 v is the attention weight of node v, and h v is the general feature of node v.",
                "cite_spans": [],
                "ref_spans": [],
                "eq_spans": [],
                "section": "Substructure mask explanation",
                "sec_num": null
            },
            {
                "text": "The key idea of perturbation-based methods is to generate masks to hide certain atoms/bonds/fragments from a GNN model in order to find which substructures may dramatically influence a model's prediction when they are absent in the input. However, the lack of chemical knowledge of the mask unit is prone to outputting confusing patterns of crucial molecular substructures that are difficult to be understood by chemists. Therefore, in this study, we adopt some common ways of splitting compounds in computational chemistry and used well-defined substructures as mask units.",
                "cite_spans": [],
                "ref_spans": [],
                "eq_spans": [],
                "section": "Substructure mask explanation",
                "sec_num": null
            },
            {
                "text": "As shown in Fig. 11d , BRICS, Murcko scaffolds and functional groups are used to generate different substructures to explain a molecular GNN model from different perspectives. As to BRICS, compounds are decomposed into the BRICS substructures based on a set of 16 bond types characterized with different chemical environments 25 . BRICS incorporates more elaborate medicinal chemistry concepts, and, for example, models explicit isosteric replacements for cyclic and acyclic cases. In addition, BRICS substructures can be assembled to form novel molecules by following a set of complementary rules. Molecular scaffold is another widely applied concept in medicinal chemistry and is mostly used to represent the core structures of bioactive compounds. A representative definition for scaffold is the Murcko framework proposed by Bemis and Murcko. Every molecule can be fragmented into a Murcko scaffold and the associated side chains 27 . Furthermore, the practice of analyzing molecules in terms of well-defined functional groups is also omnipresent in every branch of organic chemistry. In this study, we use 33 common functional groups collected in RDKit. Equipped with these three fragmentation methods, we should be able to take apart any organic molecule in terms of chemically meaningful substructures for any prediction task in medicinal chemistry and drug discovery.",
                "cite_spans": [],
                "ref_spans": [
                    {
                        "start": 17,
                        "end": 20,
                        "text": "11d",
                        "ref_id": "FIGREF11"
                    }
                ],
                "eq_spans": [],
                "section": "Substructure mask explanation",
                "sec_num": null
            },
            {
                "text": "Let us now elaborate on how the perturbation-based method works in detail. As mentioned earlier, the key idea is to identify a substructure (when missing from the input, e.g., see the masked carboxylic acid shown in Fig. 11a ) that could dramatically influence a GNN's prediction. Since a GNN predicts molecular properties by feeding a molecular embedding to a properly trained FC layer, we need to give a masked molecule a proper embedding. To this end, we consider the following definition:",
                "cite_spans": [],
                "ref_spans": [
                    {
                        "start": 221,
                        "end": 224,
                        "text": "11a",
                        "ref_id": "FIGREF11"
                    }
                ],
                "eq_spans": [],
                "section": "Substructure mask explanation",
                "sec_num": null
            },
            {
                "text": "EQUATION",
                "cite_spans": [],
                "ref_spans": [],
                "eq_spans": [
                    {
                        "start": 0,
                        "end": 8,
                        "text": "EQUATION",
                        "ref_id": "EQREF",
                        "raw_str": "molecular embedding mask = X N v = 1 \u00f0\u03c9 v \u00c1h v \u00c1mask v \u00de",
                        "eq_num": "\u00f04\u00de"
                    }
                ],
                "section": "Substructure mask explanation",
                "sec_num": null
            },
            {
                "text": "EQUATION",
                "cite_spans": [],
                "ref_spans": [],
                "eq_spans": [
                    {
                        "start": 0,
                        "end": 8,
                        "text": "EQUATION",
                        "ref_id": "EQREF",
                        "raw_str": "mask v = 1, if node v is not mask 0, if node v is mask",
                        "eq_num": "\u00f05\u00de"
                    }
                ],
                "section": "Substructure mask explanation",
                "sec_num": null
            },
            {
                "text": "where N is the number of nodes, \u03c9 v is the attention weight of node v, and h v is the general feature of node v.",
                "cite_spans": [],
                "ref_spans": [],
                "eq_spans": [],
                "section": "Substructure mask explanation",
                "sec_num": null
            },
            {
                "text": "In this study, we refer to the extent of the influence of a masked substructure on the overall prediction as the attribution. The attribution for each substructure may be determined as follows. Two GNN predictions before and after applying substructure masks onto a molecular graph are performed, and the difference between the predicted values is simply taken as the attribution:",
                "cite_spans": [],
                "ref_spans": [],
                "eq_spans": [],
                "section": "Substructure mask explanation",
                "sec_num": null
            },
            {
                "text": "EQUATION",
                "cite_spans": [],
                "ref_spans": [],
                "eq_spans": [
                    {
                        "start": 0,
                        "end": 8,
                        "text": "EQUATION",
                        "ref_id": "EQREF",
                        "raw_str": "Y = X m i Y i",
                        "eq_num": "\u00f06\u00de"
                    }
                ],
                "section": "Substructure mask explanation",
                "sec_num": null
            },
            {
                "text": "EQUATION",
                "cite_spans": [],
                "ref_spans": [],
                "eq_spans": [
                    {
                        "start": 0,
                        "end": 8,
                        "text": "EQUATION",
                        "ref_id": "EQREF",
                        "raw_str": "Y sub = X m i Y i,sub",
                        "eq_num": "\u00f07\u00de"
                    }
                ],
                "section": "Substructure mask explanation",
                "sec_num": null
            },
            {
                "text": "EQUATION",
                "cite_spans": [],
                "ref_spans": [],
                "eq_spans": [
                    {
                        "start": 0,
                        "end": 8,
                        "text": "EQUATION",
                        "ref_id": "EQREF",
                        "raw_str": "Attribution sub = Y \u00c0 sub",
                        "eq_num": "\u00f08\u00de"
                    }
                ],
                "section": "Substructure mask explanation",
                "sec_num": null
            },
            {
                "text": "where sub is the mask substructure, m is the number of the RGCN models and 10 is used in this study, and i is the i th RGCN model. For a more intuitive visualization of interpretation analysis, we normalize the attribution scores of molecular substructures to Attri-bution_N with values ranging between 0 and 1.",
                "cite_spans": [],
                "ref_spans": [],
                "eq_spans": [],
                "section": "Substructure mask explanation",
                "sec_num": null
            },
            {
                "text": "After message passing, a node's hidden state gets updated by the information conveyed by adjacent atoms/bonds. Therefore, when we mask a node, it is not just about masking an atom but about masking the chemical environment centered on that atom. And the chemical environment contains information of adjacent atoms, while the information of the adjacent atoms weakens as the path to the central atom grows. Therefore, masking a node can be considered as masking the main information of the central atom, and also masking part of the information of the adjacent atoms/bonds. For ease of understanding, in this article, the masking of a node is simply depicted as masking just the node itself.",
                "cite_spans": [],
                "ref_spans": [],
                "eq_spans": [],
                "section": "Substructure mask explanation",
                "sec_num": null
            },
            {
                "text": "Chemical substructures often do not exhibit biological activity by themselves alone, while the manifestation of biological activity emerges when certain chemical substructures in a compound interact together. For example, a single amino group does not pose a risk of mutagenicity, but it becomes a genotoxic group with a high risk of mutagenicity when it is attached to a benzene ring. For the sac of ensuring calculation efficiency, SME does not adopt Shapley values to fairly assign attribute values to different substructures, but only calculates attribute values based on the changes between predicted values, which may overlook contribution by some substructures. In order to solve the above problems, we adopt a compensation strategy: find the most positive/negative substructures through the combination of substructures to avoid overlooking some important substructures, and thus explore the SAR more comprehensively. We randomly combined and masked the BRICS substructures and Murcko substructures of a molecule, and calculated the attribution for each substructure combination. Some representative combinations of the Murcko substructures of Aspirin are provided in Fig. 1d , and there are 7 combinations base on 3 substructures. As the number of fragments increases, the number of possible substructure combinations increases exponentially and leads to extremely large cost. Hence, we adopt a suboptimal solution in this study that a maximum of 100 combinations of BRICS substructures and 100 combinations of Murcko fragments are analyzed per molecule. The current combination method is a simple random combination, and advanced algorithms such as Monte Carlo tree search will be adopted to explore the attribution of different fragment combinations more efficiently in the future.",
                "cite_spans": [],
                "ref_spans": [
                    {
                        "start": 1181,
                        "end": 1183,
                        "text": "1d",
                        "ref_id": "FIGREF0"
                    }
                ],
                "eq_spans": [],
                "section": "Combination of the BRICS and Murcko substructures",
                "sec_num": null
            },
            {
                "text": "Each dataset is randomly split into the training set, validation set, and test set by a ratio of 8:1:1. First, we conduct the hyperparameter optimization based on the predictive performance on the validation set. And the Tree Parzen Estimator (TPE) algorithm in Hyperopt (version 0.2.7) is used for the hyperparameter optimization in this study. The optimized hyperparameters are then used to build the RGCN submodels with different random seeds, and the ten sub-models are integrated to build the consensus model. The model construction is implemented using python (3.7) with dgl-cuda11.0(0.7.1), hyperopt (0.2.7) and pytorch (1.11.0). The data processing and metrics calculation are implemented using python (3.7) with scikit-learn (1.0.2), numpy (1.21.5) and pandas (1.3.5). The detailed information about the hyperparameters is listed in Supplementary Table 6 . The regression tasks are evaluated by the squared determination coefficient (R\u00b2), and the classification tasks are evaluated by the area under the receiver operating characteristic curve (ROC-AUC).",
                "cite_spans": [],
                "ref_spans": [
                    {
                        "start": 862,
                        "end": 863,
                        "text": "6",
                        "ref_id": null
                    }
                ],
                "eq_spans": [],
                "section": "Model construction and evaluation",
                "sec_num": null
            },
            {
                "text": "Nature Communications | (2023) 14:2585",
                "cite_spans": [],
                "ref_spans": [],
                "eq_spans": [],
                "section": "",
                "sec_num": null
            },
            {
                "text": "https://doi.org/10.1038/s41467-023-38192-3 Nature Communications | (2023) 14:2585",
                "cite_spans": [],
                "ref_spans": [],
                "eq_spans": [],
                "section": "",
                "sec_num": null
            }
        ],
        "back_matter": [
            {
                "text": "This study was financially supported by National Key R&D Program of China (2021YFF1201400), National Natural Science Foundation of China (22220102001), and Natural Science Foundation of Zhejiang Province of China (LD22H300001).",
                "cite_spans": [],
                "ref_spans": [],
                "eq_spans": [],
                "section": "Acknowledgements",
                "sec_num": null
            },
            {
                "text": "The ESOL, Mutagenicity, hERG and BBBP datasets used in this study and the data generated in this study are available at https://doi.org/10. 5281/zenodo.7707093 66 . Supplementary Data, including Supplementary Data 1, Supplementary Data 2, and Supplementary Data 3, is provided alongside this paper.",
                "cite_spans": [],
                "ref_spans": [],
                "eq_spans": [],
                "section": "Data availability",
                "sec_num": null
            },
            {
                "text": "The Supplementary Data and codes of SME are available at https://doi. org/10.5281/zenodo.7707093 66 .",
                "cite_spans": [],
                "ref_spans": [],
                "eq_spans": [],
                "section": "Code availability",
                "sec_num": null
            },
            {
                "text": "Further information on research design is available in the Nature Portfolio Reporting Summary linked to this article. ",
                "cite_spans": [],
                "ref_spans": [],
                "eq_spans": [],
                "section": "Reporting summary",
                "sec_num": null
            },
            {
                "text": "The authors declare no competing interests.",
                "cite_spans": [],
                "ref_spans": [],
                "eq_spans": [],
                "section": "Competing interests",
                "sec_num": null
            },
            {
                "text": "The online version contains supplementary material available at https://doi.org/10.1038/s41467-023-38192-3.Correspondence and requests for materials should be addressed to Dongsheng Cao, Chang-Yu Hsieh or Tingjun Hou.Peer review information Nature Communications thanks Gunnar Mathiason and the anonymous reviewers for their contribution to the peer review of this work. A peer review report is available.Reprints and permissions information is available at http://www.nature.com/reprints Publisher's note Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.Open Access This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit http://creativecommons.org/ licenses/by/4.0/.",
                "cite_spans": [],
                "ref_spans": [],
                "eq_spans": [],
                "section": "Supplementary information",
                "sec_num": null
            }
        ],
        "bib_entries": {
            "BIBREF0": {
                "ref_id": "b0",
                "title": "PotentialNet for molecular property prediction",
                "authors": [
                    {
                        "first": "E",
                        "middle": [
                            "N"
                        ],
                        "last": "Feinberg",
                        "suffix": ""
                    }
                ],
                "year": 2018,
                "venue": "ACS Cent. Sci",
                "volume": "4",
                "issue": "",
                "pages": "1520--1530",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Feinberg, E. N. et al. PotentialNet for molecular property prediction. ACS Cent. Sci. 4, 1520-1530 (2018).",
                "links": null
            },
            "BIBREF1": {
                "ref_id": "b1",
                "title": "A compact review of molecular property prediction with graph neural networks",
                "authors": [
                    {
                        "first": "O",
                        "middle": [],
                        "last": "Wieder",
                        "suffix": ""
                    }
                ],
                "year": 2020,
                "venue": "Drug Discov. Today.: Technol",
                "volume": "37",
                "issue": "",
                "pages": "1--12",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Wieder, O. et al. A compact review of molecular property prediction with graph neural networks. Drug Discov. Today.: Technol. 37, 1-12 (2020).",
                "links": null
            },
            "BIBREF2": {
                "ref_id": "b2",
                "title": "Analyzing learned molecular representations for property prediction",
                "authors": [
                    {
                        "first": "K",
                        "middle": [],
                        "last": "Yang",
                        "suffix": ""
                    }
                ],
                "year": 2019,
                "venue": "J. Chem. Inf. Modeling",
                "volume": "59",
                "issue": "",
                "pages": "3370--3388",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Yang, K. et al. Analyzing learned molecular representations for property prediction. J. Chem. Inf. Modeling 59, 3370-3388 (2019).",
                "links": null
            },
            "BIBREF3": {
                "ref_id": "b3",
                "title": "Deep learning in drug discovery",
                "authors": [
                    {
                        "first": "E",
                        "middle": [],
                        "last": "Gawehn",
                        "suffix": ""
                    },
                    {
                        "first": "J",
                        "middle": [
                            "A"
                        ],
                        "last": "Hiss",
                        "suffix": ""
                    },
                    {
                        "first": "G",
                        "middle": [],
                        "last": "Schneider",
                        "suffix": ""
                    }
                ],
                "year": 2016,
                "venue": "Mol. Inform",
                "volume": "35",
                "issue": "",
                "pages": "3--14",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Gawehn, E., Hiss, J. A. & Schneider, G. Deep learning in drug dis- covery. Mol. Inform. 35, 3-14 (2016).",
                "links": null
            },
            "BIBREF4": {
                "ref_id": "b4",
                "title": "QSAR without borders",
                "authors": [
                    {
                        "first": "E",
                        "middle": [
                            "N"
                        ],
                        "last": "Muratov",
                        "suffix": ""
                    }
                ],
                "year": 2020,
                "venue": "Chem. Soc. Rev",
                "volume": "49",
                "issue": "",
                "pages": "3525--3564",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Muratov, E. N. et al. QSAR without borders. Chem. Soc. Rev. 49, 3525-3564 (2020).",
                "links": null
            },
            "BIBREF5": {
                "ref_id": "b5",
                "title": "Stop explaining black box machine learning models for high stakes decisions and use interpretable models instead",
                "authors": [
                    {
                        "first": "C",
                        "middle": [],
                        "last": "Rudin",
                        "suffix": ""
                    }
                ],
                "year": 2019,
                "venue": "Nat. Mach. Intell",
                "volume": "1",
                "issue": "",
                "pages": "206--215",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Rudin, C. Stop explaining black box machine learning models for high stakes decisions and use interpretable models instead. Nat. Mach. Intell. 1, 206-215 (2019).",
                "links": null
            },
            "BIBREF6": {
                "ref_id": "b6",
                "title": "Model agnostic generation of counterfactual explanations for molecules",
                "authors": [
                    {
                        "first": "G",
                        "middle": [
                            "P"
                        ],
                        "last": "Wellawatte",
                        "suffix": ""
                    },
                    {
                        "first": "A",
                        "middle": [],
                        "last": "Seshadri",
                        "suffix": ""
                    },
                    {
                        "first": "A",
                        "middle": [
                            "D"
                        ],
                        "last": "White",
                        "suffix": ""
                    }
                ],
                "year": 2022,
                "venue": "Chem. Sci",
                "volume": "13",
                "issue": "",
                "pages": "3697--3705",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Wellawatte, G. P., Seshadri, A. & White, A. D. Model agnostic gen- eration of counterfactual explanations for molecules. Chem. Sci. 13, 3697-3705 (2022).",
                "links": null
            },
            "BIBREF7": {
                "ref_id": "b7",
                "title": "Drug discovery with explainable artificial intelligence",
                "authors": [
                    {
                        "first": "J",
                        "middle": [],
                        "last": "Jim\u00e9nez-Luna",
                        "suffix": ""
                    },
                    {
                        "first": "F",
                        "middle": [],
                        "last": "Grisoni",
                        "suffix": ""
                    },
                    {
                        "first": "G",
                        "middle": [],
                        "last": "Schneider",
                        "suffix": ""
                    }
                ],
                "year": 2020,
                "venue": "Nat. Mach. Intell",
                "volume": "2",
                "issue": "",
                "pages": "573--584",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Jim\u00e9nez-Luna, J., Grisoni, F. & Schneider, G. Drug discovery with explainable artificial intelligence. Nat. Mach. Intell. 2, 573-584 (2020).",
                "links": null
            },
            "BIBREF8": {
                "ref_id": "b8",
                "title": "The blood-brain barrier (BBB) score",
                "authors": [
                    {
                        "first": "M",
                        "middle": [],
                        "last": "Gupta",
                        "suffix": ""
                    },
                    {
                        "first": "H",
                        "middle": [
                            "J"
                        ],
                        "last": "Lee",
                        "suffix": ""
                    },
                    {
                        "first": "C",
                        "middle": [
                            "J"
                        ],
                        "last": "Barden",
                        "suffix": ""
                    },
                    {
                        "first": "D",
                        "middle": [
                            "F"
                        ],
                        "last": "Weaver",
                        "suffix": ""
                    }
                ],
                "year": 2019,
                "venue": "J. Medicinal Chem",
                "volume": "62",
                "issue": "",
                "pages": "9824--9836",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Gupta, M., Lee, H. J., Barden, C. J. & Weaver, D. F. The blood-brain barrier (BBB) score. J. Medicinal Chem. 62, 9824-9836 (2019).",
                "links": null
            },
            "BIBREF9": {
                "ref_id": "b9",
                "title": "CNS physicochemical property space shaped by a diverse set of molecules with experimentally determined exposure in the mouse brain: miniperspective",
                "authors": [
                    {
                        "first": "Z",
                        "middle": [],
                        "last": "Rankovic",
                        "suffix": ""
                    }
                ],
                "year": 2017,
                "venue": "J. Medicinal Chem",
                "volume": "60",
                "issue": "",
                "pages": "5943--5954",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Rankovic, Z. CNS physicochemical property space shaped by a diverse set of molecules with experimentally determined exposure in the mouse brain: miniperspective. J. Medicinal Chem. 60, 5943-5954 (2017).",
                "links": null
            },
            "BIBREF10": {
                "ref_id": "b10",
                "title": "Molecular property design: does everyone get it?",
                "authors": [
                    {
                        "first": "P",
                        "middle": [
                            "D"
                        ],
                        "last": "Leeson",
                        "suffix": ""
                    },
                    {
                        "first": "R",
                        "middle": [
                            "J"
                        ],
                        "last": "Young",
                        "suffix": ""
                    }
                ],
                "year": 2015,
                "venue": "",
                "volume": "",
                "issue": "",
                "pages": "",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Leeson, P. D. & Young, R.J. Molecular property design: does everyone get it?). ACS Publications (2015).",
                "links": null
            },
            "BIBREF11": {
                "ref_id": "b11",
                "title": "Interpretation of quantitative structure-activity relationship models: past, present, and future",
                "authors": [
                    {
                        "first": "P",
                        "middle": [],
                        "last": "Polishchuk",
                        "suffix": ""
                    }
                ],
                "year": 2017,
                "venue": "J. Chem. Inf. Modeling",
                "volume": "57",
                "issue": "",
                "pages": "2618--2639",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Polishchuk, P. Interpretation of quantitative structure-activity rela- tionship models: past, present, and future. J. Chem. Inf. Modeling 57, 2618-2639 (2017).",
                "links": null
            },
            "BIBREF12": {
                "ref_id": "b12",
                "title": "Improving molecular graph neural network explainability with orthonormalization and induced sparsity",
                "authors": [
                    {
                        "first": "R",
                        "middle": [],
                        "last": "Henderson",
                        "suffix": ""
                    },
                    {
                        "first": "D.-A",
                        "middle": [],
                        "last": "Clevert",
                        "suffix": ""
                    },
                    {
                        "first": "F",
                        "middle": [],
                        "last": "Montanari",
                        "suffix": ""
                    }
                ],
                "year": 2021,
                "venue": "International Conference on Machine Learning) PMLR",
                "volume": "",
                "issue": "",
                "pages": "",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Henderson, R., Clevert, D.-A., & Montanari, F. Improving molecular graph neural network explainability with orthonormalization and induced sparsity. In: International Conference on Machine Learning) PMLR (2021).",
                "links": null
            },
            "BIBREF13": {
                "ref_id": "b13",
                "title": "Explainability in graph neural networks: A taxonomic survey",
                "authors": [
                    {
                        "first": "H",
                        "middle": [],
                        "last": "Yuan",
                        "suffix": ""
                    },
                    {
                        "first": "H",
                        "middle": [],
                        "last": "Yu",
                        "suffix": ""
                    },
                    {
                        "first": "S",
                        "middle": [],
                        "last": "Gui",
                        "suffix": ""
                    },
                    {
                        "first": "S",
                        "middle": [],
                        "last": "Ji",
                        "suffix": ""
                    }
                ],
                "year": 2022,
                "venue": "IEEE Transactions on Pattern Analysis and Machine Intelligence",
                "volume": "",
                "issue": "",
                "pages": "",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Yuan, H., Yu, H., Gui, S. & Ji, S. Explainability in graph neural net- works: A taxonomic survey. In: IEEE Transactions on Pattern Analysis and Machine Intelligence (2022).",
                "links": null
            },
            "BIBREF14": {
                "ref_id": "b14",
                "title": "Gnnexplainer: generating explanations for graph neural networks",
                "authors": [
                    {
                        "first": "Z",
                        "middle": [],
                        "last": "Ying",
                        "suffix": ""
                    },
                    {
                        "first": "D",
                        "middle": [],
                        "last": "Bourgeois",
                        "suffix": ""
                    },
                    {
                        "first": "J",
                        "middle": [],
                        "last": "You",
                        "suffix": ""
                    },
                    {
                        "first": "M",
                        "middle": [],
                        "last": "Zitnik",
                        "suffix": ""
                    },
                    {
                        "first": "J",
                        "middle": [],
                        "last": "Leskovec",
                        "suffix": ""
                    }
                ],
                "year": 2019,
                "venue": "Advances in neural information processing systems",
                "volume": "32",
                "issue": "",
                "pages": "",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Ying, Z., Bourgeois, D., You, J., Zitnik, M. & Leskovec, J. Gnnexplai- ner: generating explanations for graph neural networks. Advances in neural information processing systems 32, (2019).",
                "links": null
            },
            "BIBREF15": {
                "ref_id": "b15",
                "title": "Parameterized explainer for graph neural network",
                "authors": [
                    {
                        "first": "D",
                        "middle": [],
                        "last": "Luo",
                        "suffix": ""
                    }
                ],
                "year": 2020,
                "venue": "Adv. neural Inf. Process. Syst",
                "volume": "33",
                "issue": "",
                "pages": "19620--19631",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Luo, D. et al. Parameterized explainer for graph neural network. Adv. neural Inf. Process. Syst. 33, 19620-19631 (2020).",
                "links": null
            },
            "BIBREF16": {
                "ref_id": "b16",
                "title": "Pgm-explainer: Probabilistic graphical model explanations for graph neural networks",
                "authors": [
                    {
                        "first": "M",
                        "middle": [],
                        "last": "Vu",
                        "suffix": ""
                    },
                    {
                        "first": "M",
                        "middle": [
                            "T"
                        ],
                        "last": "Thai",
                        "suffix": ""
                    }
                ],
                "year": 2020,
                "venue": "Adv. neural Inf. Process. Syst",
                "volume": "33",
                "issue": "",
                "pages": "12225--12235",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Vu, M. & Thai, M. T. Pgm-explainer: Probabilistic graphical model explanations for graph neural networks. Adv. neural Inf. Process. Syst. 33, 12225-12235 (2020).",
                "links": null
            },
            "BIBREF17": {
                "ref_id": "b17",
                "title": "Explainability techniques for graph convolutional networks",
                "authors": [
                    {
                        "first": "F",
                        "middle": [],
                        "last": "Baldassarre",
                        "suffix": ""
                    },
                    {
                        "first": "H",
                        "middle": [],
                        "last": "Azizpour",
                        "suffix": ""
                    }
                ],
                "year": 2019,
                "venue": "",
                "volume": "",
                "issue": "",
                "pages": "",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Baldassarre, F. & Azizpour, H. Explainability techniques for graph convolutional networks. arXiv preprint arXiv:190513686 (2019).",
                "links": null
            },
            "BIBREF18": {
                "ref_id": "b18",
                "title": "On explainability of graph neural networks via subgraph explorations",
                "authors": [
                    {
                        "first": "H",
                        "middle": [],
                        "last": "Yuan",
                        "suffix": ""
                    },
                    {
                        "first": "H",
                        "middle": [],
                        "last": "Yu",
                        "suffix": ""
                    },
                    {
                        "first": "J",
                        "middle": [],
                        "last": "Wang",
                        "suffix": ""
                    },
                    {
                        "first": "K",
                        "middle": [],
                        "last": "Li",
                        "suffix": ""
                    },
                    {
                        "first": "S",
                        "middle": [],
                        "last": "Ji",
                        "suffix": ""
                    }
                ],
                "year": 2021,
                "venue": "International Conference on Machine Learning) PMLR",
                "volume": "",
                "issue": "",
                "pages": "",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Yuan, H., Yu, H., Wang, J., Li, K., & Ji, S. On explainability of graph neural networks via subgraph explorations. In: International Con- ference on Machine Learning) PMLR (2021).",
                "links": null
            },
            "BIBREF19": {
                "ref_id": "b19",
                "title": "Explainability methods for graph convolutional neural networks",
                "authors": [
                    {
                        "first": "P",
                        "middle": [
                            "E"
                        ],
                        "last": "Pope",
                        "suffix": ""
                    },
                    {
                        "first": "S",
                        "middle": [],
                        "last": "Kolouri",
                        "suffix": ""
                    },
                    {
                        "first": "M",
                        "middle": [],
                        "last": "Rostami",
                        "suffix": ""
                    },
                    {
                        "first": "C",
                        "middle": [
                            "E"
                        ],
                        "last": "Martin",
                        "suffix": ""
                    },
                    {
                        "first": "H",
                        "middle": [],
                        "last": "Hoffmann",
                        "suffix": ""
                    }
                ],
                "year": 2019,
                "venue": "Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition)",
                "volume": "",
                "issue": "",
                "pages": "",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Pope, P. E., Kolouri, S., Rostami, M., Martin, C. E., & Hoffmann, H. Explainability methods for graph convolutional neural networks. In: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition) (2019).",
                "links": null
            },
            "BIBREF20": {
                "ref_id": "b20",
                "title": "Layerwise Relevance Visualization in Convolutional Text Graph Classifiers",
                "authors": [
                    {
                        "first": "R",
                        "middle": [],
                        "last": "Schwarzenberg",
                        "suffix": ""
                    },
                    {
                        "first": "M",
                        "middle": [],
                        "last": "H\u00fcbner",
                        "suffix": ""
                    },
                    {
                        "first": "D",
                        "middle": [],
                        "last": "Harbecke",
                        "suffix": ""
                    },
                    {
                        "first": "C",
                        "middle": [],
                        "last": "Alt",
                        "suffix": ""
                    },
                    {
                        "first": "L",
                        "middle": [],
                        "last": "Hennig",
                        "suffix": ""
                    }
                ],
                "year": 2019,
                "venue": "Proceedings of the Thirteenth Workshop on Graph-Based Methods for Natural Language Processing (TextGraphs-13))",
                "volume": "",
                "issue": "",
                "pages": "58--62",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Schwarzenberg, R., H\u00fcbner, M., Harbecke, D., Alt, C. & Hennig, L. Layerwise Relevance Visualization in Convolutional Text Graph Classifiers. In: Proceedings of the Thirteenth Workshop on Graph- Based Methods for Natural Language Processing (TextGraphs-13)). 58-62 (2019).",
                "links": null
            },
            "BIBREF21": {
                "ref_id": "b21",
                "title": "Higher-order explanations of graph neural networks via relevant walks",
                "authors": [
                    {
                        "first": "T",
                        "middle": [],
                        "last": "Schnake",
                        "suffix": ""
                    }
                ],
                "year": 2021,
                "venue": "IEEE transactions on pattern analysis and machine intelligence",
                "volume": "44",
                "issue": "",
                "pages": "7581--7596",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Schnake, T. et al. Higher-order explanations of graph neural net- works via relevant walks. In: IEEE transactions on pattern analysis and machine intelligence 44, 7581-7596 (2021).",
                "links": null
            },
            "BIBREF22": {
                "ref_id": "b22",
                "title": "Local interpretable model explanations for graph neural networks",
                "authors": [
                    {
                        "first": "Q",
                        "middle": [],
                        "last": "Huang",
                        "suffix": ""
                    },
                    {
                        "first": "M",
                        "middle": [],
                        "last": "Yamada",
                        "suffix": ""
                    },
                    {
                        "first": "Y",
                        "middle": [],
                        "last": "Tian",
                        "suffix": ""
                    },
                    {
                        "first": "D",
                        "middle": [],
                        "last": "Singh",
                        "suffix": ""
                    },
                    {
                        "first": "Y",
                        "middle": [],
                        "last": "Chang",
                        "suffix": ""
                    },
                    {
                        "first": "",
                        "middle": [],
                        "last": "Graphlime",
                        "suffix": ""
                    }
                ],
                "year": 2022,
                "venue": "IEEE Transactions on Knowledge and Data Engineering",
                "volume": "",
                "issue": "",
                "pages": "1--6",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Huang, Q., Yamada, M., Tian, Y., Singh, D. & Chang, Y. Graphlime: Local interpretable model explanations for graph neural networks. IEEE Transactions on Knowledge and Data Engineering, 1-6 (2022).",
                "links": null
            },
            "BIBREF23": {
                "ref_id": "b23",
                "title": "Towards model-level explanations of graph neural networks",
                "authors": [
                    {
                        "first": "H",
                        "middle": [],
                        "last": "Yuan",
                        "suffix": ""
                    },
                    {
                        "first": "J",
                        "middle": [],
                        "last": "Tang",
                        "suffix": ""
                    },
                    {
                        "first": "X",
                        "middle": [],
                        "last": "Hu",
                        "suffix": ""
                    },
                    {
                        "first": "S",
                        "middle": [],
                        "last": "Ji",
                        "suffix": ""
                    },
                    {
                        "first": "",
                        "middle": [],
                        "last": "Xgnn",
                        "suffix": ""
                    }
                ],
                "year": 2020,
                "venue": "Proceedings of the 26th ACM SIGKDD International Conference on Knowledge Discovery & Data Mining)",
                "volume": "",
                "issue": "",
                "pages": "",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Yuan, H., Tang, J., Hu, X. & Ji, S. Xgnn: Towards model-level explanations of graph neural networks. In: Proceedings of the 26th ACM SIGKDD International Conference on Knowledge Discovery & Data Mining) (2020).",
                "links": null
            },
            "BIBREF24": {
                "ref_id": "b24",
                "title": "On the Art of Compiling and Using'Drug-Like'Chemical Fragment Spaces",
                "authors": [
                    {
                        "first": "J",
                        "middle": [],
                        "last": "Degen",
                        "suffix": ""
                    },
                    {
                        "first": "C",
                        "middle": [],
                        "last": "Wegscheid-Gerlach",
                        "suffix": ""
                    },
                    {
                        "first": "A",
                        "middle": [],
                        "last": "Zaliani",
                        "suffix": ""
                    },
                    {
                        "first": "M",
                        "middle": [],
                        "last": "Rarey",
                        "suffix": ""
                    }
                ],
                "year": 2008,
                "venue": "ChemMedChem: Chem. Enabling Drug Discov",
                "volume": "3",
                "issue": "",
                "pages": "1503--1507",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Degen, J., Wegscheid-Gerlach, C., Zaliani, A. & Rarey, M. On the Art of Compiling and Using'Drug-Like'Chemical Fragment Spaces. ChemMedChem: Chem. Enabling Drug Discov. 3, 1503-1507 (2008).",
                "links": null
            },
            "BIBREF25": {
                "ref_id": "b25",
                "title": "Computational exploration of molecular scaffolds in medicinal chemistry: Miniperspective",
                "authors": [
                    {
                        "first": "Y",
                        "middle": [],
                        "last": "Hu",
                        "suffix": ""
                    },
                    {
                        "first": "D",
                        "middle": [],
                        "last": "Stumpfe",
                        "suffix": ""
                    },
                    {
                        "first": "Jr",
                        "middle": [],
                        "last": "Bajorath",
                        "suffix": ""
                    }
                ],
                "year": 2016,
                "venue": "J. Medicinal Chem",
                "volume": "59",
                "issue": "",
                "pages": "4062--4076",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Hu, Y., Stumpfe, D. & Bajorath, Jr. Computational exploration of molecular scaffolds in medicinal chemistry: Miniperspective. J. Medicinal Chem. 59, 4062-4076 (2016).",
                "links": null
            },
            "BIBREF26": {
                "ref_id": "b26",
                "title": "The properties of known drugs. 1. Molecular frameworks",
                "authors": [
                    {
                        "first": "G",
                        "middle": [
                            "W"
                        ],
                        "last": "Bemis",
                        "suffix": ""
                    },
                    {
                        "first": "M",
                        "middle": [
                            "A"
                        ],
                        "last": "Murcko",
                        "suffix": ""
                    }
                ],
                "year": 1996,
                "venue": "J. Medicinal Chem",
                "volume": "39",
                "issue": "",
                "pages": "2887--2893",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Bemis, G. W. & Murcko, M. A. The properties of known drugs. 1. Molecular frameworks. J. Medicinal Chem. 39, 2887-2893 (1996).",
                "links": null
            },
            "BIBREF27": {
                "ref_id": "b27",
                "title": "Beyond generative models: superfast traversal, optimization, novelty, exploration and discovery (STONED) algorithm for molecules using SELFIES",
                "authors": [
                    {
                        "first": "A",
                        "middle": [],
                        "last": "Nigam",
                        "suffix": ""
                    },
                    {
                        "first": "R",
                        "middle": [],
                        "last": "Pollice",
                        "suffix": ""
                    },
                    {
                        "first": "M",
                        "middle": [],
                        "last": "Krenn",
                        "suffix": ""
                    },
                    {
                        "first": "G",
                        "middle": [],
                        "last": "Dos Passos Gomes",
                        "suffix": ""
                    },
                    {
                        "first": "A",
                        "middle": [],
                        "last": "Aspuru-Guzik",
                        "suffix": ""
                    }
                ],
                "year": 2021,
                "venue": "Chem. Sci",
                "volume": "12",
                "issue": "",
                "pages": "7079--7090",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Nigam, A., Pollice, R., Krenn, M., dos Passos Gomes, G. & Aspuru- Guzik, A. Beyond generative models: superfast traversal, optimi- zation, novelty, exploration and discovery (STONED) algorithm for molecules using SELFIES. Chem. Sci. 12, 7079-7090 (2021).",
                "links": null
            },
            "BIBREF28": {
                "ref_id": "b28",
                "title": "Explaining molecular properties with natural language",
                "authors": [
                    {
                        "first": "H",
                        "middle": [
                            "A"
                        ],
                        "last": "Gandhi",
                        "suffix": ""
                    },
                    {
                        "first": "A",
                        "middle": [
                            "D"
                        ],
                        "last": "White",
                        "suffix": ""
                    }
                ],
                "year": 2022,
                "venue": "",
                "volume": "",
                "issue": "",
                "pages": "",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Gandhi, H. A. & White A. D. Explaining molecular properties with natural language. (2022).",
                "links": null
            },
            "BIBREF29": {
                "ref_id": "b29",
                "title": "Medicinal chemistry of hERG optimizations: highlights and hang-ups",
                "authors": [
                    {
                        "first": "C",
                        "middle": [],
                        "last": "Jamieson",
                        "suffix": ""
                    },
                    {
                        "first": "E",
                        "middle": [
                            "M"
                        ],
                        "last": "Moir",
                        "suffix": ""
                    },
                    {
                        "first": "Z",
                        "middle": [],
                        "last": "Rankovic",
                        "suffix": ""
                    },
                    {
                        "first": "G",
                        "middle": [],
                        "last": "Wishart",
                        "suffix": ""
                    }
                ],
                "year": 2006,
                "venue": "J. Medicinal Chem",
                "volume": "49",
                "issue": "",
                "pages": "5029--5046",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Jamieson, C., Moir, E. M., Rankovic, Z. & Wishart, G. Medicinal chemistry of hERG optimizations: highlights and hang-ups. J. Medicinal Chem. 49, 5029-5046 (2006).",
                "links": null
            },
            "BIBREF30": {
                "ref_id": "b30",
                "title": "hERG toxicity assessment: Useful guidelines for drug design",
                "authors": [
                    {
                        "first": "A",
                        "middle": [],
                        "last": "Garrido",
                        "suffix": ""
                    },
                    {
                        "first": "A",
                        "middle": [],
                        "last": "Lepailleur",
                        "suffix": ""
                    },
                    {
                        "first": "S",
                        "middle": [
                            "M"
                        ],
                        "last": "Mignani",
                        "suffix": ""
                    },
                    {
                        "first": "P",
                        "middle": [],
                        "last": "Dallemagne",
                        "suffix": ""
                    },
                    {
                        "first": "C",
                        "middle": [],
                        "last": "Rochais",
                        "suffix": ""
                    }
                ],
                "year": 2020,
                "venue": "Eur. J. Medicinal Chem",
                "volume": "195",
                "issue": "",
                "pages": "",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Garrido, A., Lepailleur, A., Mignani, S. M., Dallemagne, P. & Rochais, C. hERG toxicity assessment: Useful guidelines for drug design. Eur. J. Medicinal Chem. 195, 112290 (2020).",
                "links": null
            },
            "BIBREF31": {
                "ref_id": "b31",
                "title": "Development of safe drugs: the hERG challenge",
                "authors": [
                    {
                        "first": "S",
                        "middle": [],
                        "last": "Kalyaanamoorthy",
                        "suffix": ""
                    },
                    {
                        "first": "K",
                        "middle": [
                            "H"
                        ],
                        "last": "Barakat",
                        "suffix": ""
                    }
                ],
                "year": 2018,
                "venue": "Medicinal Res. Rev",
                "volume": "38",
                "issue": "",
                "pages": "525--555",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Kalyaanamoorthy, S. & Barakat, K. H. Development of safe drugs: the hERG challenge. Medicinal Res. Rev. 38, 525-555 (2018).",
                "links": null
            },
            "BIBREF32": {
                "ref_id": "b32",
                "title": "Lead compound optimization strategy (5)-reducing the hERG cardiac toxicity in drug development",
                "authors": [
                    {
                        "first": "S",
                        "middle": [],
                        "last": "Zhou",
                        "suffix": ""
                    },
                    {
                        "first": "J",
                        "middle": [],
                        "last": "Wang",
                        "suffix": ""
                    },
                    {
                        "first": "H",
                        "middle": [],
                        "last": "Liu",
                        "suffix": ""
                    }
                ],
                "year": 2016,
                "venue": "Yao xue xue bao= Acta Pharmaceutica Sin",
                "volume": "51",
                "issue": "",
                "pages": "1530--1539",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Zhou, S., Wang, J. & Liu, H. Lead compound optimization strategy (5)-reducing the hERG cardiac toxicity in drug development. Yao xue xue bao= Acta Pharmaceutica Sin. 51, 1530-1539 (2016).",
                "links": null
            },
            "BIBREF33": {
                "ref_id": "b33",
                "title": "Design of bivalent ligands using hydrogen bond linkers: synthesis and evaluation of inhibitors for human \u03b2-tryptase",
                "authors": [
                    {
                        "first": "R",
                        "middle": [
                            "J"
                        ],
                        "last": "Vaz",
                        "suffix": ""
                    }
                ],
                "year": 2004,
                "venue": "Bioorg. Medicinal Chem. Lett",
                "volume": "14",
                "issue": "",
                "pages": "6053--6056",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Vaz, R. J. et al. Design of bivalent ligands using hydrogen bond linkers: synthesis and evaluation of inhibitors for human \u03b2-tryptase. Bioorg. Medicinal Chem. Lett. 14, 6053-6056 (2004).",
                "links": null
            },
            "BIBREF34": {
                "ref_id": "b34",
                "title": "Fluoroethoxy-1, 4-diphenethylpiperidine and piperazine derivatives: Potent and selective inhibitors of [3H] dopamine uptake at the vesicular monoamine transporter-2",
                "authors": [
                    {
                        "first": "E",
                        "middle": [
                            "R"
                        ],
                        "last": "Hankosky",
                        "suffix": ""
                    }
                ],
                "year": 2017,
                "venue": "Bioorg. Medicinal Chem. Lett",
                "volume": "27",
                "issue": "",
                "pages": "5467--5472",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Hankosky, E. R. et al. Fluoroethoxy-1, 4-diphenethylpiperidine and piperazine derivatives: Potent and selective inhibitors of [3H] dopamine uptake at the vesicular monoamine transporter-2. Bioorg. Medicinal Chem. Lett. 27, 5467-5472 (2017).",
                "links": null
            },
            "BIBREF35": {
                "ref_id": "b35",
                "title": "Antagonists of human CCR5 receptor containing 4-(pyrazolyl) piperidine side chains. Part 3: SAR studies on the benzylpyrazole segment",
                "authors": [
                    {
                        "first": "M",
                        "middle": [],
                        "last": "Shu",
                        "suffix": ""
                    }
                ],
                "year": 2004,
                "venue": "Bioorg. Medicinal Chem. Lett",
                "volume": "14",
                "issue": "",
                "pages": "947--952",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Shu, M. et al. Antagonists of human CCR5 receptor containing 4- (pyrazolyl) piperidine side chains. Part 3: SAR studies on the ben- zylpyrazole segment. Bioorg. Medicinal Chem. Lett. 14, 947-952 (2004).",
                "links": null
            },
            "BIBREF36": {
                "ref_id": "b36",
                "title": "NR2B-selective N-methyl-D-aspartate antagonists: synthesis and evaluation of 5-substituted benzimidazoles",
                "authors": [
                    {
                        "first": "J",
                        "middle": [
                            "A"
                        ],
                        "last": "Mccauley",
                        "suffix": ""
                    }
                ],
                "year": 2004,
                "venue": "J. Medicinal Chem",
                "volume": "47",
                "issue": "",
                "pages": "2089--2096",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "McCauley, J. A. et al. NR2B-selective N-methyl-D-aspartate antagonists: synthesis and evaluation of 5-substituted benzimida- zoles. J. Medicinal Chem. 47, 2089-2096 (2004).",
                "links": null
            },
            "BIBREF37": {
                "ref_id": "b37",
                "title": "Quantitative evaluation of explainable graph neural networks for molecular property prediction",
                "authors": [
                    {
                        "first": "J",
                        "middle": [],
                        "last": "Rao",
                        "suffix": ""
                    },
                    {
                        "first": "S",
                        "middle": [],
                        "last": "Zheng",
                        "suffix": ""
                    },
                    {
                        "first": "Y",
                        "middle": [],
                        "last": "Lu",
                        "suffix": ""
                    },
                    {
                        "first": "Y",
                        "middle": [],
                        "last": "Yang",
                        "suffix": ""
                    }
                ],
                "year": 2022,
                "venue": "Patterns",
                "volume": "3",
                "issue": "",
                "pages": "",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Rao, J., Zheng, S., Lu, Y. & Yang, Y. Quantitative evaluation of explainable graph neural networks for molecular property predic- tion. Patterns 3, 100628 (2022).",
                "links": null
            },
            "BIBREF38": {
                "ref_id": "b38",
                "title": "Artificial intelligence uncovers carcinogenic human metabolites",
                "authors": [
                    {
                        "first": "A",
                        "middle": [],
                        "last": "Mittal",
                        "suffix": ""
                    }
                ],
                "year": 2022,
                "venue": "Nat. Chem. Biol",
                "volume": "18",
                "issue": "",
                "pages": "1204--1213",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Mittal, A. et al. Artificial intelligence uncovers carcinogenic human metabolites. Nat. Chem. Biol. 18, 1204-1213 (2022).",
                "links": null
            },
            "BIBREF39": {
                "ref_id": "b39",
                "title": "Improvement in aqueous solubility in small molecule drug discovery programs by disruption of molecular planarity and symmetry",
                "authors": [
                    {
                        "first": "M",
                        "middle": [],
                        "last": "Ishikawa",
                        "suffix": ""
                    },
                    {
                        "first": "Y",
                        "middle": [],
                        "last": "Hashimoto",
                        "suffix": ""
                    }
                ],
                "year": 2011,
                "venue": "J. Medicinal Chem",
                "volume": "54",
                "issue": "",
                "pages": "1539--1554",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Ishikawa, M. & Hashimoto, Y. Improvement in aqueous solubility in small molecule drug discovery programs by disruption of mole- cular planarity and symmetry. J. Medicinal Chem. 54, 1539-1554 (2011).",
                "links": null
            },
            "BIBREF40": {
                "ref_id": "b40",
                "title": "ESOL: estimating aqueous solubility directly from molecular structure",
                "authors": [
                    {
                        "first": "J",
                        "middle": [
                            "S"
                        ],
                        "last": "Delaney",
                        "suffix": ""
                    }
                ],
                "year": 2004,
                "venue": "J. Chem. Inf. computer Sci",
                "volume": "44",
                "issue": "",
                "pages": "1000--1005",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Delaney, J. S. ESOL: estimating aqueous solubility directly from molecular structure. J. Chem. Inf. computer Sci. 44, 1000-1005 (2004).",
                "links": null
            },
            "BIBREF41": {
                "ref_id": "b41",
                "title": "Recent advances on aqueous solubility prediction",
                "authors": [
                    {
                        "first": "J",
                        "middle": [],
                        "last": "Wang",
                        "suffix": ""
                    },
                    {
                        "first": "T",
                        "middle": [],
                        "last": "Hou",
                        "suffix": ""
                    }
                ],
                "year": 2011,
                "venue": "Combinatorial Chem. high. throughput Screen",
                "volume": "14",
                "issue": "",
                "pages": "328--338",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Wang, J. & Hou, T. Recent advances on aqueous solubility predic- tion. Combinatorial Chem. high. throughput Screen. 14, 328-338 (2011).",
                "links": null
            },
            "BIBREF42": {
                "ref_id": "b42",
                "title": "A self-attention based message passing neural network for predicting molecular lipophilicity and aqueous solubility",
                "authors": [
                    {
                        "first": "B",
                        "middle": [],
                        "last": "Tang",
                        "suffix": ""
                    }
                ],
                "year": 2020,
                "venue": "J. Cheminformatics",
                "volume": "12",
                "issue": "",
                "pages": "1--9",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Tang, B. et al. A self-attention based message passing neural net- work for predicting molecular lipophilicity and aqueous solubility. J. Cheminformatics 12, 1-9 (2020).",
                "links": null
            },
            "BIBREF43": {
                "ref_id": "b43",
                "title": "Deep architectures and deep learning in chemoinformatics: the prediction of aqueous solubility for drug-like molecules",
                "authors": [
                    {
                        "first": "A",
                        "middle": [],
                        "last": "Lusci",
                        "suffix": ""
                    },
                    {
                        "first": "G",
                        "middle": [],
                        "last": "Pollastri",
                        "suffix": ""
                    },
                    {
                        "first": "P",
                        "middle": [],
                        "last": "Baldi",
                        "suffix": ""
                    }
                ],
                "year": 2013,
                "venue": "J. Chem. Inf. Modeling",
                "volume": "53",
                "issue": "",
                "pages": "1563--1575",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Lusci, A., Pollastri, G. & Baldi, P. Deep architectures and deep learning in chemoinformatics: the prediction of aqueous solubility for drug-like molecules. J. Chem. Inf. Modeling 53, 1563-1575 (2013).",
                "links": null
            },
            "BIBREF44": {
                "ref_id": "b44",
                "title": "Drug solubility: importance and enhancement techniques",
                "authors": [
                    {
                        "first": "K",
                        "middle": [
                            "T"
                        ],
                        "last": "Savjani",
                        "suffix": ""
                    },
                    {
                        "first": "A",
                        "middle": [
                            "K"
                        ],
                        "last": "Gajjar",
                        "suffix": ""
                    },
                    {
                        "first": "J",
                        "middle": [
                            "K"
                        ],
                        "last": "Savjani",
                        "suffix": ""
                    }
                ],
                "year": 2012,
                "venue": "International Scholarly Research Notices",
                "volume": "",
                "issue": "",
                "pages": "",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Savjani, K. T., Gajjar, A. K. & Savjani, J. K. Drug solubility: importance and enhancement techniques. International Scholarly Research Notices 2012 (2012).",
                "links": null
            },
            "BIBREF45": {
                "ref_id": "b45",
                "title": "Mining toxicity information from large amounts of toxicity data",
                "authors": [
                    {
                        "first": "Z",
                        "middle": [],
                        "last": "Wu",
                        "suffix": ""
                    }
                ],
                "year": 2021,
                "venue": "J. Medicinal Chem",
                "volume": "64",
                "issue": "",
                "pages": "6924--6936",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Wu, Z. et al. Mining toxicity information from large amounts of toxicity data. J. Medicinal Chem. 64, 6924-6936 (2021).",
                "links": null
            },
            "BIBREF46": {
                "ref_id": "b46",
                "title": "Comparison of in silico models for prediction of mutagenicity",
                "authors": [
                    {
                        "first": "N",
                        "middle": [
                            "G"
                        ],
                        "last": "Bakhtyari",
                        "suffix": ""
                    },
                    {
                        "first": "G",
                        "middle": [],
                        "last": "Raitano",
                        "suffix": ""
                    },
                    {
                        "first": "E",
                        "middle": [],
                        "last": "Benfenati",
                        "suffix": ""
                    },
                    {
                        "first": "T",
                        "middle": [],
                        "last": "Martin",
                        "suffix": ""
                    },
                    {
                        "first": "D",
                        "middle": [],
                        "last": "Young",
                        "suffix": ""
                    }
                ],
                "year": 2013,
                "venue": "J. Environ. Sci. Health, Part C",
                "volume": "31",
                "issue": "",
                "pages": "45--66",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Bakhtyari, N. G., Raitano, G., Benfenati, E., Martin, T. & Young, D. Comparison of in silico models for prediction of mutagenicity. J. Environ. Sci. Health, Part C. 31, 45-66 (2013).",
                "links": null
            },
            "BIBREF47": {
                "ref_id": "b47",
                "title": "In silico prediction of chemical Ames mutagenicity",
                "authors": [
                    {
                        "first": "C",
                        "middle": [],
                        "last": "Xu",
                        "suffix": ""
                    }
                ],
                "year": 2012,
                "venue": "J. Chem. Inf. Modeling",
                "volume": "52",
                "issue": "",
                "pages": "2840--2847",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Xu, C. et al. In silico prediction of chemical Ames mutagenicity. J. Chem. Inf. Modeling 52, 2840-2847 (2012).",
                "links": null
            },
            "BIBREF48": {
                "ref_id": "b48",
                "title": "Benchmark data set for in silico prediction of Ames mutagenicity",
                "authors": [
                    {
                        "first": "K",
                        "middle": [],
                        "last": "Hansen",
                        "suffix": ""
                    }
                ],
                "year": 2009,
                "venue": "J. Chem. Inf. Modeling",
                "volume": "49",
                "issue": "",
                "pages": "2077--2081",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Hansen, K. et al. Benchmark data set for in silico prediction of Ames mutagenicity. J. Chem. Inf. Modeling 49, 2077-2081 (2009).",
                "links": null
            },
            "BIBREF49": {
                "ref_id": "b49",
                "title": "Universal approach for structural interpretation of QSAR/QSPR models",
                "authors": [
                    {
                        "first": "P",
                        "middle": [
                            "G"
                        ],
                        "last": "Polishchuk",
                        "suffix": ""
                    },
                    {
                        "first": "V",
                        "middle": [
                            "E"
                        ],
                        "last": "Kuz'min",
                        "suffix": ""
                    },
                    {
                        "first": "A",
                        "middle": [
                            "G"
                        ],
                        "last": "Artemenko",
                        "suffix": ""
                    },
                    {
                        "first": "E",
                        "middle": [
                            "N"
                        ],
                        "last": "Muratov",
                        "suffix": ""
                    }
                ],
                "year": 2013,
                "venue": "Mol. Inform",
                "volume": "32",
                "issue": "",
                "pages": "843--853",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Polishchuk, P. G., Kuz'min, V. E., Artemenko, A. G. & Muratov, E. N. Universal approach for structural interpretation of QSAR/QSPR models. Mol. Inform. 32, 843-853 (2013).",
                "links": null
            },
            "BIBREF50": {
                "ref_id": "b50",
                "title": "Derivation and validation of toxicophores for mutagenicity prediction",
                "authors": [
                    {
                        "first": "J",
                        "middle": [],
                        "last": "Kazius",
                        "suffix": ""
                    },
                    {
                        "first": "R",
                        "middle": [],
                        "last": "Mcguire",
                        "suffix": ""
                    },
                    {
                        "first": "R",
                        "middle": [],
                        "last": "Bursi",
                        "suffix": ""
                    }
                ],
                "year": 2005,
                "venue": "J. medicinal Chem",
                "volume": "48",
                "issue": "",
                "pages": "312--320",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Kazius, J., McGuire, R. & Bursi, R. Derivation and validation of tox- icophores for mutagenicity prediction. J. medicinal Chem. 48, 312-320 (2005).",
                "links": null
            },
            "BIBREF51": {
                "ref_id": "b51",
                "title": "Development of structural alerts for the in vivo micronucleus assay in rodents",
                "authors": [
                    {
                        "first": "R",
                        "middle": [],
                        "last": "Benigni",
                        "suffix": ""
                    },
                    {
                        "first": "C",
                        "middle": [],
                        "last": "Bossa",
                        "suffix": ""
                    },
                    {
                        "first": "O",
                        "middle": [],
                        "last": "Tcheremenskaia",
                        "suffix": ""
                    },
                    {
                        "first": "A",
                        "middle": [],
                        "last": "Worth",
                        "suffix": ""
                    }
                ],
                "year": 2009,
                "venue": "EUR",
                "volume": "23844",
                "issue": "",
                "pages": "1--43",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Benigni, R., Bossa, C., Tcheremenskaia, O. & Worth, A. Development of structural alerts for the in vivo micronucleus assay in rodents. EUR 23844 EN, 1-43 (2009).",
                "links": null
            },
            "BIBREF52": {
                "ref_id": "b52",
                "title": "Mechanism-based insights into removing the mutagenicity of aromatic amines by small structural alterations",
                "authors": [
                    {
                        "first": "I",
                        "middle": [],
                        "last": "Shamovsky",
                        "suffix": ""
                    }
                ],
                "year": 2021,
                "venue": "J. Medicinal Chem",
                "volume": "64",
                "issue": "",
                "pages": "8545--8563",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Shamovsky, I. et al. Mechanism-based insights into removing the mutagenicity of aromatic amines by small structural alterations. J. Medicinal Chem. 64, 8545-8563 (2021).",
                "links": null
            },
            "BIBREF53": {
                "ref_id": "b53",
                "title": "Recent developments in computational prediction of HERG blockage",
                "authors": [
                    {
                        "first": "S",
                        "middle": [],
                        "last": "Wang",
                        "suffix": ""
                    },
                    {
                        "first": "Y",
                        "middle": [],
                        "last": "Li",
                        "suffix": ""
                    },
                    {
                        "first": "L",
                        "middle": [],
                        "last": "Xu",
                        "suffix": ""
                    },
                    {
                        "first": "D",
                        "middle": [],
                        "last": "Li",
                        "suffix": ""
                    },
                    {
                        "first": "T",
                        "middle": [],
                        "last": "Hou",
                        "suffix": ""
                    }
                ],
                "year": 2013,
                "venue": "Curr. Top. Medicinal Chem",
                "volume": "13",
                "issue": "",
                "pages": "1317--1326",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Wang, S., Li, Y., Xu, L., Li, D. & Hou, T. Recent developments in computational prediction of HERG blockage. Curr. Top. Medicinal Chem. 13, 1317-1326 (2013).",
                "links": null
            },
            "BIBREF54": {
                "ref_id": "b54",
                "title": "How can we improve our understanding of cardiovascular safety liabilities to develop safer medicines?",
                "authors": [
                    {
                        "first": "H",
                        "middle": [],
                        "last": "Laverty",
                        "suffix": ""
                    }
                ],
                "year": 2011,
                "venue": "Br. J. Pharmacol",
                "volume": "163",
                "issue": "",
                "pages": "675--693",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Laverty, H. et al. How can we improve our understanding of cardi- ovascular safety liabilities to develop safer medicines? Br. J. Phar- macol. 163, 675-693 (2011).",
                "links": null
            },
            "BIBREF55": {
                "ref_id": "b55",
                "title": "In silico prediction of hERG inhibition",
                "authors": [
                    {
                        "first": "Y",
                        "middle": [],
                        "last": "Jing",
                        "suffix": ""
                    },
                    {
                        "first": "A",
                        "middle": [],
                        "last": "Easter",
                        "suffix": ""
                    },
                    {
                        "first": "D",
                        "middle": [],
                        "last": "Peters",
                        "suffix": ""
                    },
                    {
                        "first": "N",
                        "middle": [],
                        "last": "Kim",
                        "suffix": ""
                    },
                    {
                        "first": "I",
                        "middle": [
                            "J"
                        ],
                        "last": "Enyedy",
                        "suffix": ""
                    }
                ],
                "year": 2015,
                "venue": "Future Medicinal Chem",
                "volume": "7",
                "issue": "",
                "pages": "571--586",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Jing, Y., Easter, A., Peters, D., Kim, N. & Enyedy, I. J. In silico pre- diction of hERG inhibition. Future Medicinal Chem. 7, 571-586 (2015).",
                "links": null
            },
            "BIBREF56": {
                "ref_id": "b56",
                "title": "Pred-hERG: a novel web-accessible computational tool for predicting cardiac toxicity",
                "authors": [
                    {
                        "first": "R",
                        "middle": [
                            "C"
                        ],
                        "last": "Braga",
                        "suffix": ""
                    }
                ],
                "year": 2015,
                "venue": "Mol. Inform",
                "volume": "34",
                "issue": "",
                "pages": "698--701",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Braga, R. C. et al. Pred-hERG: a novel web-accessible computational tool for predicting cardiac toxicity. Mol. Inform. 34, 698-701 (2015).",
                "links": null
            },
            "BIBREF57": {
                "ref_id": "b57",
                "title": "a deep learning framework for prediction of hERG-induced cardiotoxicity",
                "authors": [
                    {
                        "first": "J",
                        "middle": [
                            "Y"
                        ],
                        "last": "Ryu",
                        "suffix": ""
                    },
                    {
                        "first": "M",
                        "middle": [
                            "Y"
                        ],
                        "last": "Lee",
                        "suffix": ""
                    },
                    {
                        "first": "J",
                        "middle": [
                            "H"
                        ],
                        "last": "Lee",
                        "suffix": ""
                    },
                    {
                        "first": "B",
                        "middle": [
                            "H"
                        ],
                        "last": "Lee",
                        "suffix": ""
                    },
                    {
                        "first": "K.-S",
                        "middle": [],
                        "last": "Oh",
                        "suffix": ""
                    },
                    {
                        "first": "",
                        "middle": [],
                        "last": "Deephit",
                        "suffix": ""
                    }
                ],
                "year": 2020,
                "venue": "Bioinformatics",
                "volume": "36",
                "issue": "",
                "pages": "3049--3055",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Ryu, J. Y., Lee, M. Y., Lee, J. H., Lee, B. H. & Oh, K.-S. DeepHIT: a deep learning framework for prediction of hERG-induced cardiotoxicity. Bioinformatics 36, 3049-3055 (2020).",
                "links": null
            },
            "BIBREF58": {
                "ref_id": "b58",
                "title": "Blood-brain barrier penetration prediction enhanced by uncertainty estimation",
                "authors": [
                    {
                        "first": "X",
                        "middle": [],
                        "last": "Tong",
                        "suffix": ""
                    }
                ],
                "year": 2022,
                "venue": "J. Cheminformatics",
                "volume": "14",
                "issue": "",
                "pages": "1--15",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Tong, X. et al. Blood-brain barrier penetration prediction enhanced by uncertainty estimation. J. Cheminformatics 14, 1-15 (2022).",
                "links": null
            },
            "BIBREF59": {
                "ref_id": "b59",
                "title": "Prediction of blood-brain barrier penetration (bbbp) based on molecular descriptors of the free-form and in-blood-form datasets",
                "authors": [
                    {
                        "first": "H",
                        "middle": [],
                        "last": "Sakiyama",
                        "suffix": ""
                    },
                    {
                        "first": "M",
                        "middle": [],
                        "last": "Fukuda",
                        "suffix": ""
                    },
                    {
                        "first": "T",
                        "middle": [],
                        "last": "Okuno",
                        "suffix": ""
                    }
                ],
                "year": 2021,
                "venue": "Molecules",
                "volume": "26",
                "issue": "",
                "pages": "",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Sakiyama, H., Fukuda, M. & Okuno, T. Prediction of blood-brain barrier penetration (bbbp) based on molecular descriptors of the free-form and in-blood-form datasets. Molecules 26, 7428 (2021).",
                "links": null
            },
            "BIBREF60": {
                "ref_id": "b60",
                "title": "MoleculeNet: a benchmark for molecular machine learning",
                "authors": [
                    {
                        "first": "Z",
                        "middle": [],
                        "last": "Wu",
                        "suffix": ""
                    }
                ],
                "year": 2018,
                "venue": "Chem. Sci",
                "volume": "9",
                "issue": "",
                "pages": "513--530",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Wu, Z. et al. MoleculeNet: a benchmark for molecular machine learning. Chem. Sci. 9, 513-530 (2018).",
                "links": null
            },
            "BIBREF61": {
                "ref_id": "b61",
                "title": "Molecular graph convolutions: moving beyond fingerprints",
                "authors": [
                    {
                        "first": "S",
                        "middle": [],
                        "last": "Kearnes",
                        "suffix": ""
                    },
                    {
                        "first": "K",
                        "middle": [],
                        "last": "Mccloskey",
                        "suffix": ""
                    },
                    {
                        "first": "M",
                        "middle": [],
                        "last": "Berndl",
                        "suffix": ""
                    },
                    {
                        "first": "V",
                        "middle": [],
                        "last": "Pande",
                        "suffix": ""
                    },
                    {
                        "first": "P",
                        "middle": [],
                        "last": "Riley",
                        "suffix": ""
                    }
                ],
                "year": 2016,
                "venue": "J. Computer-aided Mol. Des",
                "volume": "30",
                "issue": "",
                "pages": "595--608",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Kearnes, S., McCloskey, K., Berndl, M., Pande, V. & Riley, P. Mole- cular graph convolutions: moving beyond fingerprints. J. Computer-aided Mol. Des. 30, 595-608 (2016).",
                "links": null
            },
            "BIBREF62": {
                "ref_id": "b62",
                "title": "Graph Attention Networks",
                "authors": [
                    {
                        "first": "P",
                        "middle": [],
                        "last": "Veli\u010dkovi\u0107",
                        "suffix": ""
                    }
                ],
                "year": 2018,
                "venue": "International Conference on Learning Representations",
                "volume": "",
                "issue": "",
                "pages": "",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Veli\u010dkovi\u0107, P. et al. Graph Attention Networks. In: International Conference on Learning Representations (2018).",
                "links": null
            },
            "BIBREF63": {
                "ref_id": "b63",
                "title": "Pushing the boundaries of molecular representation for drug discovery with the graph attention mechanism",
                "authors": [
                    {
                        "first": "Z",
                        "middle": [],
                        "last": "Xiong",
                        "suffix": ""
                    }
                ],
                "year": 2019,
                "venue": "J. Medicinal Chem",
                "volume": "63",
                "issue": "",
                "pages": "8749--8760",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Xiong, Z. et al. Pushing the boundaries of molecular representation for drug discovery with the graph attention mechanism. J. Medicinal Chem. 63, 8749-8760 (2019).",
                "links": null
            },
            "BIBREF64": {
                "ref_id": "b64",
                "title": "Modeling relational data with graph convolutional networks",
                "authors": [
                    {
                        "first": "M",
                        "middle": [],
                        "last": "Schlichtkrull",
                        "suffix": ""
                    },
                    {
                        "first": "T",
                        "middle": [
                            "N"
                        ],
                        "last": "Kipf",
                        "suffix": ""
                    },
                    {
                        "first": "P",
                        "middle": [],
                        "last": "Bloem",
                        "suffix": ""
                    },
                    {
                        "first": "Rvd",
                        "middle": [],
                        "last": "Berg",
                        "suffix": ""
                    },
                    {
                        "first": "I",
                        "middle": [],
                        "last": "Titov",
                        "suffix": ""
                    },
                    {
                        "first": "M",
                        "middle": [],
                        "last": "Welling",
                        "suffix": ""
                    }
                ],
                "year": 2018,
                "venue": "European semantic web conference",
                "volume": "",
                "issue": "",
                "pages": "",
                "other_ids": {},
                "num": null,
                "urls": [],
                "raw_text": "Schlichtkrull, M., Kipf, T. N., Bloem, P., Berg, Rvd., Titov, I., & Well- ing, M. Modeling relational data with graph convolutional networks. In: European semantic web conference) Springer (2018).",
                "links": null
            },
            "BIBREF65": {
                "ref_id": "b65",
                "title": "Chemistry-intuitive explanation of graph neural networks for molecular property prediction with substructure masking",
                "authors": [
                    {
                        "first": "Wu",
                        "middle": [],
                        "last": "Zhenxing",
                        "suffix": ""
                    }
                ],
                "year": 2022,
                "venue": "Substructure-Mask-Explanation",
                "volume": "",
                "issue": "",
                "pages": "",
                "other_ids": {
                    "DOI": [
                        "10.5281/zenodo.7707093"
                    ]
                },
                "num": null,
                "urls": [],
                "raw_text": "Zhenxing, Wu. et al. Chemistry-intuitive explanation of graph neural networks for molecular property prediction with substructure masking. Substructure-Mask-Explanation. https://doi.org/10.5281/ zenodo.7707093 (2022).",
                "links": null
            }
        },
        "ref_entries": {
            "FIGREF0": {
                "uris": null,
                "type_str": "figure",
                "fig_num": "1",
                "text": "Fig. 1 | The SME explanation of aqueous solubility. a The attribution visualization of compound 1; b The attribution visualization of compound 2; c The attribution of the different functional groups in the whole ESOL dataset. Only the functional groups that appear more than ten times in the dataset are included in Fig. 1. Blue",
                "num": null
            },
            "FIGREF1": {
                "uris": null,
                "type_str": "figure",
                "fig_num": "2",
                "text": "Fig. 2 | The structural optimization of compound 1. The source data can be found in Supplementary Data 1. The methyl group are changed to one of the functional groups in Fig. 1c and each point represents a compound. Yellow represents the initial functional groups, red represents a more hydrophobic functional group, and blue represents a more hydrophilic functional group. Regression line with the 95% confidence interval (the blue shading) and the spearman rank correlation test are used to describe the correlation between the hydrophilicity of molecules and the attribution of functional groups. The two-sided p-value indicates the significance of the correlation.",
                "num": null
            },
            "FIGREF2": {
                "uris": null,
                "type_str": "figure",
                "fig_num": "3",
                "text": "Fig. 3 | The attribution visualization of compound 3. a The SME explanation of compound 3 based on atoms; b The SME explanation of compound 3 based on BRICS substructures; c The SME explanation of compound 3 based on functional groups; d The SME explanation of compound 3 based on Murcko substructure; e The most positive/negative component of compound 3; f The identified toxicophores; g The identified detoxifying groups.",
                "num": null
            },
            "FIGREF3": {
                "uris": null,
                "type_str": "figure",
                "fig_num": "4",
                "text": "Fig. 4 | The explanation results of compounds 7 for different methods. The right side of the figure displays explanation results from SME, and the left side presents results from other methods.",
                "num": null
            },
            "FIGREF4": {
                "uris": null,
                "type_str": "figure",
                "fig_num": "5",
                "text": "Fig. 5 | The attributions of different functional groups in the whole Mutagenicity dataset. Blue colors represent attributions lower than 0, while orange colors represent attributions higher than 0.",
                "num": null
            },
            "FIGREF5": {
                "uris": null,
                "type_str": "figure",
                "fig_num": "6",
                "text": "Fig.6| The attributions of different functional groups in the whole hERG dataset. Blue colors represent attributions lower than 0 and the substructure is unfavorable to induce toxicity, while orange colors represent attributions higher than 0 and the substructure is conductive to inducing toxicity.",
                "num": null
            },
            "FIGREF6": {
                "uris": null,
                "type_str": "figure",
                "fig_num": "7",
                "text": "Fig. 7 | The correlation of the average attributions between hERG and ESOL's functional groups. The source data can be found in Supplementary Data 2. The regression line with the 95% confidence interval (the blue shading) and the spearman rank correlation test are used to describe the correlation of the average attributions; The two-sided p-value indicates the significance of the correlation.",
                "num": null
            },
            "FIGREF7": {
                "uris": null,
                "type_str": "figure",
                "fig_num": "8",
                "text": "Fig. 8 | Some real-world structural optimization examples of hERG toxicity. a Add a functional group with an average attribution <0 to reduce the hERG toxicity; b Remove a functional group with an average attribution > 0 to reduce the hERG toxicity; c Replace a functional group with a more negative attribution to reduce the hERG toxicity.",
                "num": null
            },
            "FIGREF8": {
                "uris": null,
                "type_str": "figure",
                "fig_num": null,
                "text": "Article https://doi.org/10.1038/s41467-023-38192-3 Nature Communications | (2023) 14:2585",
                "num": null
            },
            "FIGREF9": {
                "uris": null,
                "type_str": "figure",
                "fig_num": "9",
                "text": "Fig. 9 | Attribution-based molecule generation for desired properties. a The molecules generated by recombination of BRICS fragments; b The molecules generated by recombination of top 20% BRICS fragments; c The molecules",
                "num": null
            },
            "FIGREF10": {
                "uris": null,
                "type_str": "figure",
                "fig_num": "10",
                "text": "Fig. 10 | The SAR information of BBBP mined by SME. The source data can be found in Supplementary Data 3. a The flow chart of using SME to mine SAR information. The analysis of functional group attribution generated by SME are used to construct a desired relationship between molecular functional groups and the BBBP. By constructing different prediction models of physicochemical properties, the relationship linking molecular functional groups and physicochemical properties can be obtained based on the functional group attribution. With the functional group as a link, the relationship between BBBP and the physicochemical properties can be established. Regression lines with the 95% confidence interval (the blue shading) and spearman rank correlation test are used to describe the correlation between BBBP and the physicochemical properties. The two-sided pvalue indicates the significance of the correlation. b The correlation of the average attributions between BBBP and BBBP_MW's functional groups; c The correlation of the average attributions between BBBP and BBBP_LogP's functional groups; d The correlation of the average attributions between BBBP and BBBP_TPSA' functional groups; e The correlation of the average attributions between BBBP and BBBP_HBDs's functional groups.",
                "num": null
            },
            "FIGREF11": {
                "uris": null,
                "type_str": "figure",
                "fig_num": "11",
                "text": "Fig. 11 | The architecture of the consensus models and substructure mask explanation methods. a The architecture of the RGCN sub-models; b The consensus model used for molecular property prediction; c The attribution calculation based on substructure mask explanation; d BRICS substructures, Murcko substructures, functional groups and the combination of Murcko substructures.",
                "num": null
            },
            "TABREF0": {
                "content": "<table><tr><td>Model</td><td>Type</td><td>Metric</td><td>Performance</td></tr><tr><td>ESOL</td><td>regression</td><td>R 2</td><td>0.927</td></tr><tr><td>Mutagenicity</td><td>classification</td><td>ROC-AUC</td><td>0.901</td></tr><tr><td>hERG</td><td>classification</td><td>ROC-AUC</td><td>0.862</td></tr><tr><td>BBBP</td><td>classification</td><td>ROC-AUC</td><td>0.919</td></tr></table>",
                "type_str": "table",
                "text": "The performance of the consensus models on the test sets",
                "num": null,
                "html": null
            }
        }
    }
}